/*
 luteg.connector.js
 https://github.com/luteg-software/lupe.io
 (c) Luteg Software Technologies
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(q,f,h){q!=Array.prototype&&q!=Object.prototype&&(q[f]=h.value)};$jscomp.getGlobal=function(q){return"undefined"!=typeof window&&window===q?q:"undefined"!=typeof global&&null!=global?global:q};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var q=0;return function(f){return $jscomp.SYMBOL_PREFIX+(f||"")+q++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var q=$jscomp.global.Symbol.iterator;q||(q=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[q]&&$jscomp.defineProperty(Array.prototype,q,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(q){var f=0;return $jscomp.iteratorPrototype(function(){return f<q.length?{done:!1,value:q[f++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(q){$jscomp.initSymbolIterator();q={next:q};q[$jscomp.global.Symbol.iterator]=function(){return this};return q};$jscomp.iteratorFromArray=function(q,f){$jscomp.initSymbolIterator();q instanceof String&&(q+="");var h=0,g={next:function(){if(h<q.length){var c=h++;return{value:f(c,q[c]),done:!1}}g.next=function(){return{done:!0,value:void 0}};return g.next()}};g[Symbol.iterator]=function(){return g};return g};
$jscomp.polyfill=function(q,f,h,g){if(f){h=$jscomp.global;q=q.split(".");for(g=0;g<q.length-1;g++){var c=q[g];c in h||(h[c]={});h=h[c]}q=q[q.length-1];g=h[q];f=f(g);f!=g&&null!=f&&$jscomp.defineProperty(h,q,{configurable:!0,writable:!0,value:f})}};$jscomp.polyfill("Array.prototype.keys",function(q){return q?q:function(){return $jscomp.iteratorFromArray(this,function(f){return f})}},"es6","es3");
!function(q){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=q();else if("function"==typeof define&&define.amd)define([],q);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self);f.io=q()}}(function(){return function c(f,h,g){function a(d,e){if(!h[d]){if(!f[d]){var n="function"==typeof require&&require;if(!e&&n)return n(d,!0);if(b)return b(d,!0);throw Error("Cannot find module '"+d+"'");}e=h[d]={exports:{}};f[d][0].call(e.exports,
function(b){var c=f[d][1][b];return a(c?c:b)},e,e.exports,c,f,h,g)}return h[d].exports}for(var b="function"==typeof require&&require,e=0;e<g.length;e++)a(g[e]);return a}({1:[function(f,h,g){h.exports=f("./lib/")},{"./lib/":2}],2:[function(f,h,g){function c(b,c){"object"==typeof b&&(c=b,b=void 0);c=c||{};b=a(b);var n=b.source,v=b.id;c.forceNew||c["force new connection"]||!1===c.multiplex?(d("ignoring socket cache for %s",n),c=e(n,c)):(m[v]||(d("new io instance for %s",n),m[v]=e(n,c)),c=m[v]);return c.socket(b.path)}
var a=f("./url"),b=f("socket.io-parser"),e=f("./manager"),d=f("debug")("socket.io-client");h.exports=g=c;var m=g.managers={};g.protocol=b.protocol;g.connect=c;g.Manager=f("./manager");g.Socket=f("./socket")},{"./manager":3,"./socket":5,"./url":6,debug:10,"socket.io-parser":46}],3:[function(f,h,g){function c(a,b){if(!(this instanceof c))return new c(a,b);a&&"object"==typeof a&&(b=a,a=void 0);b=b||{};b.path=b.path||"/socket.io";this.nsps={};this.subs=[];this.opts=b;this.reconnection(!1!==b.reconnection);
this.reconnectionAttempts(b.reconnectionAttempts||Infinity);this.reconnectionDelay(b.reconnectionDelay||1E3);this.reconnectionDelayMax(b.reconnectionDelayMax||5E3);this.randomizationFactor(b.randomizationFactor||.5);this.backoff=new u({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==b.timeout?2E4:b.timeout);this.readyState="closed";this.uri=a;this.connected=[];this.encoding=!1;this.packetBuffer=[];this.encoder=new e.Encoder;this.decoder=
new e.Decoder;(this.autoConnect=!1!==b.autoConnect)&&this.open()}f("./url");var a=f("engine.io-client"),b=f("./socket");g=f("component-emitter");var e=f("socket.io-parser"),d=f("./on"),m=f("component-bind");f("object-component");var n=f("debug")("socket.io-client:manager"),x=f("indexof"),u=f("backo2");h.exports=c;c.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var a in this.nsps)this.nsps[a].emit.apply(this.nsps[a],arguments)};c.prototype.updateSocketIds=function(){for(var a in this.nsps)this.nsps[a].id=
this.engine.id};g(c.prototype);c.prototype.reconnection=function(a){if(!arguments.length)return this._reconnection;this._reconnection=!!a;return this};c.prototype.reconnectionAttempts=function(a){if(!arguments.length)return this._reconnectionAttempts;this._reconnectionAttempts=a;return this};c.prototype.reconnectionDelay=function(a){if(!arguments.length)return this._reconnectionDelay;this._reconnectionDelay=a;this.backoff&&this.backoff.setMin(a);return this};c.prototype.randomizationFactor=function(a){if(!arguments.length)return this._randomizationFactor;
this._randomizationFactor=a;this.backoff&&this.backoff.setJitter(a);return this};c.prototype.reconnectionDelayMax=function(a){if(!arguments.length)return this._reconnectionDelayMax;this._reconnectionDelayMax=a;this.backoff&&this.backoff.setMax(a);return this};c.prototype.timeout=function(a){if(!arguments.length)return this._timeout;this._timeout=a;return this};c.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()};c.prototype.open=
c.prototype.connect=function(b){n("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;n("opening %s",this.uri);var c=this.engine=a(this.uri,this.opts),e=this;this.readyState="opening";this.skipReconnect=!1;var v=d(c,"open",function(){e.onopen();b&&b()}),r=d(c,"error",function(a){n("connect_error");e.cleanup();e.readyState="closed";e.emitAll("connect_error",a);if(b){var c=Error("Connection error");c.data=a;b(c)}else e.maybeReconnectOnOpen()});if(!1!==this._timeout){var m=
this._timeout;n("connect attempt will timeout after %d",m);var g=setTimeout(function(){n("connect attempt timed out after %d",m);v.destroy();c.close();c.emit("error","timeout");e.emitAll("connect_timeout",m)},m);this.subs.push({destroy:function(){clearTimeout(g)}})}this.subs.push(v);this.subs.push(r);return this};c.prototype.onopen=function(){n("open");this.cleanup();this.readyState="open";this.emit("open");var a=this.engine;this.subs.push(d(a,"data",m(this,"ondata")));this.subs.push(d(this.decoder,
"decoded",m(this,"ondecoded")));this.subs.push(d(a,"error",m(this,"onerror")));this.subs.push(d(a,"close",m(this,"onclose")))};c.prototype.ondata=function(a){this.decoder.add(a)};c.prototype.ondecoded=function(a){this.emit("packet",a)};c.prototype.onerror=function(a){n("error",a);this.emitAll("error",a)};c.prototype.socket=function(a){var c=this.nsps[a];if(!c){c=new b(this,a);this.nsps[a]=c;var d=this;c.on("connect",function(){c.id=d.engine.id;~x(d.connected,c)||d.connected.push(c)})}return c};c.prototype.destroy=
function(a){a=x(this.connected,a);~a&&this.connected.splice(a,1);this.connected.length||this.close()};c.prototype.packet=function(a){n("writing packet %j",a);var b=this;b.encoding?b.packetBuffer.push(a):(b.encoding=!0,this.encoder.encode(a,function(a){for(var c=0;c<a.length;c++)b.engine.write(a[c]);b.encoding=!1;b.processPacketQueue()}))};c.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var a=this.packetBuffer.shift();this.packet(a)}};c.prototype.cleanup=function(){for(var a;a=
this.subs.shift();)a.destroy();this.packetBuffer=[];this.encoding=!1;this.decoder.destroy()};c.prototype.close=c.prototype.disconnect=function(){this.skipReconnect=!0;this.backoff.reset();this.readyState="closed";this.engine&&this.engine.close()};c.prototype.onclose=function(a){n("close");this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",a);this._reconnection&&!this.skipReconnect&&this.reconnect()};c.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;
var a=this;if(this.backoff.attempts>=this._reconnectionAttempts)n("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var b=this.backoff.duration();n("will wait %dms before reconnect attempt",b);this.reconnecting=!0;var c=setTimeout(function(){a.skipReconnect||(n("attempting reconnect"),a.emitAll("reconnect_attempt",a.backoff.attempts),a.emitAll("reconnecting",a.backoff.attempts),a.skipReconnect||a.open(function(b){b?(n("reconnect attempt error"),a.reconnecting=
!1,a.reconnect(),a.emitAll("reconnect_error",b.data)):(n("reconnect success"),a.onreconnect())}))},b);this.subs.push({destroy:function(){clearTimeout(c)}})}};c.prototype.onreconnect=function(){var a=this.backoff.attempts;this.reconnecting=!1;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",a)}},{"./on":4,"./socket":5,"./url":6,backo2:7,"component-bind":8,"component-emitter":9,debug:10,"engine.io-client":11,indexof:42,"object-component":43,"socket.io-parser":46}],4:[function(f,
h,g){h.exports=function(c,a,b){c.on(a,b);return{destroy:function(){c.removeListener(a,b)}}}},{}],5:[function(f,h,g){function c(a,b){this.io=a;this.nsp=b;this.json=this;this.ids=0;this.acks={};this.io.autoConnect&&this.open();this.receiveBuffer=[];this.sendBuffer=[];this.connected=!1;this.disconnected=!0}var a=f("socket.io-parser");g=f("component-emitter");var b=f("to-array"),e=f("./on"),d=f("component-bind"),m=f("debug")("socket.io-client:socket"),n=f("has-binary");h.exports=c;var x={connect:1,connect_error:1,
connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},u=g.prototype.emit;g(c.prototype);c.prototype.subEvents=function(){if(!this.subs){var a=this.io;this.subs=[e(a,"open",d(this,"onopen")),e(a,"packet",d(this,"onpacket")),e(a,"close",d(this,"onclose"))]}};c.prototype.open=c.prototype.connect=function(){if(this.connected)return this;this.subEvents();this.io.open();if("open"==this.io.readyState)this.onopen();return this};c.prototype.send=
function(){var a=b(arguments);a.unshift("message");this.emit.apply(this,a);return this};c.prototype.emit=function(c){if(x.hasOwnProperty(c))return u.apply(this,arguments),this;var d=b(arguments),e=a.EVENT;n(d)&&(e=a.BINARY_EVENT);e={type:e,data:d};"function"==typeof d[d.length-1]&&(m("emitting packet with ack id %d",this.ids),this.acks[this.ids]=d.pop(),e.id=this.ids++);this.connected?this.packet(e):this.sendBuffer.push(e);return this};c.prototype.packet=function(a){a.nsp=this.nsp;this.io.packet(a)};
c.prototype.onopen=function(){m("transport is open - connecting");"/"!=this.nsp&&this.packet({type:a.CONNECT})};c.prototype.onclose=function(a){m("close (%s)",a);this.connected=!1;this.disconnected=!0;delete this.id;this.emit("disconnect",a)};c.prototype.onpacket=function(b){if(b.nsp==this.nsp)switch(b.type){case a.CONNECT:this.onconnect();break;case a.EVENT:this.onevent(b);break;case a.BINARY_EVENT:this.onevent(b);break;case a.ACK:this.onack(b);break;case a.BINARY_ACK:this.onack(b);break;case a.DISCONNECT:this.ondisconnect();
break;case a.ERROR:this.emit("error",b.data)}};c.prototype.onevent=function(a){var b=a.data||[];m("emitting event %j",b);null!=a.id&&(m("attaching ack callback to event"),b.push(this.ack(a.id)));this.connected?u.apply(this,b):this.receiveBuffer.push(b)};c.prototype.ack=function(c){var d=this,e=!1;return function(){if(!e){e=!0;var y=b(arguments);m("sending ack %j",y);var r=n(y)?a.BINARY_ACK:a.ACK;d.packet({type:r,id:c,data:y})}}};c.prototype.onack=function(a){m("calling ack %s with %j",a.id,a.data);
this.acks[a.id].apply(this,a.data);delete this.acks[a.id]};c.prototype.onconnect=function(){this.connected=!0;this.disconnected=!1;this.emit("connect");this.emitBuffered()};c.prototype.emitBuffered=function(){var a;for(a=0;a<this.receiveBuffer.length;a++)u.apply(this,this.receiveBuffer[a]);this.receiveBuffer=[];for(a=0;a<this.sendBuffer.length;a++)this.packet(this.sendBuffer[a]);this.sendBuffer=[]};c.prototype.ondisconnect=function(){m("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};
c.prototype.destroy=function(){if(this.subs){for(var a=0;a<this.subs.length;a++)this.subs[a].destroy();this.subs=null}this.io.destroy(this)};c.prototype.close=c.prototype.disconnect=function(){this.connected&&(m("performing disconnect (%s)",this.nsp),this.packet({type:a.DISCONNECT}));this.destroy();if(this.connected)this.onclose("io client disconnect");return this}},{"./on":4,"component-bind":8,"component-emitter":9,debug:10,"has-binary":38,"socket.io-parser":46,"to-array":50}],6:[function(f,h,g){(function(c){var a=
f("parseuri"),b=f("debug")("socket.io-client:url");h.exports=function(e,d){var m=e;d=d||c.location;null==e&&(e=d.protocol+"//"+d.host);"string"==typeof e&&("/"==e.charAt(0)&&(e="/"==e.charAt(1)?d.protocol+e:d.hostname+e),/^(https?|wss?):\/\//.test(e)||(b("protocol-less url %s",e),e="undefined"!=typeof d?d.protocol+"//"+e:"https://"+e),b("parse %s",e),m=a(e));m.port||(/^(http|ws)$/.test(m.protocol)?m.port="80":/^(http|ws)s$/.test(m.protocol)&&(m.port="443"));m.path=m.path||"/";m.id=m.protocol+"://"+
m.host+":"+m.port;m.href=m.protocol+"://"+m.host+(d&&d.port==m.port?"":":"+m.port);return m}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{debug:10,parseuri:44}],7:[function(f,h,g){function c(a){a=a||{};this.ms=a.min||100;this.max=a.max||1E4;this.factor=a.factor||2;this.jitter=0<a.jitter&&1>=a.jitter?a.jitter:0;this.attempts=0}h.exports=c;c.prototype.duration=function(){var a=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var b=Math.random(),c=
Math.floor(b*this.jitter*a);a=0==(Math.floor(10*b)&1)?a-c:a+c}return Math.min(a,this.max)|0};c.prototype.reset=function(){this.attempts=0};c.prototype.setMin=function(a){this.ms=a};c.prototype.setMax=function(a){this.max=a};c.prototype.setJitter=function(a){this.jitter=a}},{}],8:[function(f,h,g){var c=[].slice;h.exports=function(a,b){"string"==typeof b&&(b=a[b]);if("function"!=typeof b)throw Error("bind() requires a function");var e=c.call(arguments,2);return function(){return b.apply(a,e.concat(c.call(arguments)))}}},
{}],9:[function(f,h,g){function c(a){if(a){for(var b in c.prototype)a[b]=c.prototype[b];return a}}h.exports=c;c.prototype.on=c.prototype.addEventListener=function(a,b){this._callbacks=this._callbacks||{};(this._callbacks[a]=this._callbacks[a]||[]).push(b);return this};c.prototype.once=function(a,b){function c(){d.off(a,c);b.apply(this,arguments)}var d=this;this._callbacks=this._callbacks||{};c.fn=b;this.on(a,c);return this};c.prototype.off=c.prototype.removeListener=c.prototype.removeAllListeners=
c.prototype.removeEventListener=function(a,b){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks={},this;var c=this._callbacks[a];if(!c)return this;if(1==arguments.length)return delete this._callbacks[a],this;for(var d,m=0;m<c.length;m++)if(d=c[m],d===b||d.fn===b){c.splice(m,1);break}return this};c.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),c=this._callbacks[a];if(c){c=c.slice(0);for(var d=0,m=c.length;d<m;++d)c[d].apply(this,
b)}return this};c.prototype.listeners=function(a){this._callbacks=this._callbacks||{};return this._callbacks[a]||[]};c.prototype.hasListeners=function(a){return!!this.listeners(a).length}},{}],10:[function(f,h,g){function c(a){return c.enabled(a)?function(b){b instanceof Error&&(b=b.stack||b.message);var e=new Date,d=e-(c[a]||e);c[a]=e;b=a+" "+b+" +"+c.humanize(d);window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}h.exports=c;c.names=[];c.skips=
[];c.enable=function(a){try{localStorage.debug=a}catch(m){}for(var b=(a||"").split(/[\s,]+/),e=b.length,d=0;d<e;d++)a=b[d].replace("*",".*?"),"-"===a[0]?c.skips.push(new RegExp("^"+a.substr(1)+"$")):c.names.push(new RegExp("^"+a+"$"))};c.disable=function(){c.enable("")};c.humanize=function(a){return 36E5<=a?(a/36E5).toFixed(1)+"h":6E4<=a?(a/6E4).toFixed(1)+"m":1E3<=a?(a/1E3|0)+"s":a+"ms"};c.enabled=function(a){for(var b=0,e=c.skips.length;b<e;b++)if(c.skips[b].test(a))return!1;b=0;for(e=c.names.length;b<
e;b++)if(c.names[b].test(a))return!0;return!1};try{window.localStorage&&c.enable(localStorage.debug)}catch(a){}},{}],11:[function(f,h,g){h.exports=f("./lib/")},{"./lib/":12}],12:[function(f,h,g){h.exports=f("./socket");h.exports.parser=f("engine.io-parser")},{"./socket":13,"engine.io-parser":25}],13:[function(f,h,g){(function(c){function a(b,d){if(!(this instanceof a))return new a(b,d);d=d||{};b&&"object"==typeof b&&(d=b,b=null);b&&(b=g(b),d.host=b.host,d.secure="https"==b.protocol||"wss"==b.protocol,
d.port=b.port,b.query&&(d.query=b.query));this.secure=null!=d.secure?d.secure:c.location&&"https:"==location.protocol;d.host&&(b=d.host.split(":"),d.hostname=b.shift(),b.length?d.port=b.pop():d.port||(d.port=this.secure?"443":"80"));this.agent=d.agent||!1;this.hostname=d.hostname||(c.location?location.hostname:"localhost");this.port=d.port||(c.location&&location.port?location.port:this.secure?443:80);this.query=d.query||{};"string"==typeof this.query&&(this.query=v.decode(this.query));this.upgrade=
!1!==d.upgrade;this.path=(d.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!d.forceJSONP;this.jsonp=!1!==d.jsonp;this.forceBase64=!!d.forceBase64;this.enablesXDR=!!d.enablesXDR;this.timestampParam=d.timestampParam||"t";this.timestampRequests=d.timestampRequests;this.transports=d.transports||["polling","websocket"];this.readyState="";this.writeBuffer=[];this.callbackBuffer=[];this.policyPort=d.policyPort||843;this.rememberUpgrade=d.rememberUpgrade||!1;this.binaryType=null;this.onlyBinaryUpgrades=
d.onlyBinaryUpgrades;this.pfx=d.pfx||null;this.key=d.key||null;this.passphrase=d.passphrase||null;this.cert=d.cert||null;this.ca=d.ca||null;this.ciphers=d.ciphers||null;this.rejectUnauthorized=d.rejectUnauthorized||null;this.open()}var b=f("./transports"),e=f("component-emitter"),d=f("debug")("engine.io-client:socket"),m=f("indexof"),n=f("engine.io-parser"),g=f("parseuri"),u=f("parsejson"),v=f("parseqs");h.exports=a;a.priorWebsocketSuccess=!1;e(a.prototype);a.protocol=n.protocol;a.Socket=a;a.Transport=
f("./transport");a.transports=f("./transports");a.parser=f("engine.io-parser");a.prototype.createTransport=function(a){d('creating transport "%s"',a);var c=this.query,e={},y;for(y in c)c.hasOwnProperty(y)&&(e[y]=c[y]);e.EIO=n.protocol;e.transport=a;this.id&&(e.sid=this.id);return new b[a]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:e,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,
timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized})};a.prototype.open=function(){if(this.rememberUpgrade&&a.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))var b="websocket";else{if(0==this.transports.length){var c=this;setTimeout(function(){c.emit("error","No transports available")},0);return}b=this.transports[0]}this.readyState=
"opening";try{b=this.createTransport(b)}catch(E){this.transports.shift();this.open();return}b.open();this.setTransport(b)};a.prototype.setTransport=function(a){d("setting transport %s",a.name);var b=this;this.transport&&(d("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners());this.transport=a;a.on("drain",function(){b.onDrain()}).on("packet",function(a){b.onPacket(a)}).on("error",function(a){b.onError(a)}).on("close",function(){b.onClose("transport close")})};
a.prototype.probe=function(b){function c(){if(p.onlyBinaryUpgrades){var c=!this.supportsBinary&&p.transport.supportsBinary;x=x||c}x||(d('probe transport "%s" opened',b),f.send([{type:"ping",data:"probe"}]),f.once("packet",function(c){x||("pong"==c.type&&"probe"==c.data?(d('probe transport "%s" pong',b),p.upgrading=!0,p.emit("upgrading",f),f&&(a.priorWebsocketSuccess="websocket"==f.name,d('pausing current transport "%s"',p.transport.name),p.transport.pause(function(){x||"closed"==p.readyState||(d("changing transport and sending upgrade packet"),
g(),p.setTransport(f),f.send([{type:"upgrade"}]),p.emit("upgrade",f),f=null,p.upgrading=!1,p.flush())}))):(d('probe transport "%s" failed',b),c=Error("probe error"),c.transport=f.name,p.emit("upgradeError",c)))}))}function e(){x||(x=!0,g(),f.close(),f=null)}function r(a){var c=Error("probe error: "+a);c.transport=f.name;e();d('probe transport "%s" failed because of error: %s',b,a);p.emit("upgradeError",c)}function y(){r("transport closed")}function n(){r("socket closed")}function m(a){f&&a.name!=
f.name&&(d('"%s" works - aborting "%s"',a.name,f.name),e())}function g(){f.removeListener("open",c);f.removeListener("error",r);f.removeListener("close",y);p.removeListener("close",n);p.removeListener("upgrading",m)}d('probing transport "%s"',b);var f=this.createTransport(b,{probe:1}),x=!1,p=this;a.priorWebsocketSuccess=!1;f.once("open",c);f.once("error",r);f.once("close",y);this.once("close",n);this.once("upgrading",m);f.open()};a.prototype.onOpen=function(){d("socket open");this.readyState="open";
a.priorWebsocketSuccess="websocket"==this.transport.name;this.emit("open");this.flush();if("open"==this.readyState&&this.upgrade&&this.transport.pause){d("starting upgrade probes");for(var b=0,c=this.upgrades.length;b<c;b++)this.probe(this.upgrades[b])}};a.prototype.onPacket=function(a){if("opening"==this.readyState||"open"==this.readyState)switch(d('socket receive: type "%s", data "%s"',a.type,a.data),this.emit("packet",a),this.emit("heartbeat"),a.type){case "open":this.onHandshake(u(a.data));break;
case "pong":this.setPing();break;case "error":var b=Error("server error");b.code=a.data;this.emit("error",b);break;case "message":this.emit("data",a.data),this.emit("message",a.data)}else d('packet received with socket readyState "%s"',this.readyState)};a.prototype.onHandshake=function(a){this.emit("handshake",a);this.id=a.sid;this.transport.query.sid=a.sid;this.upgrades=this.filterUpgrades(a.upgrades);this.pingInterval=a.pingInterval;this.pingTimeout=a.pingTimeout;this.onOpen();"closed"!=this.readyState&&
(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))};a.prototype.onHeartbeat=function(a){clearTimeout(this.pingTimeoutTimer);var b=this;b.pingTimeoutTimer=setTimeout(function(){if("closed"!=b.readyState)b.onClose("ping timeout")},a||b.pingInterval+b.pingTimeout)};a.prototype.setPing=function(){var a=this;clearTimeout(a.pingIntervalTimer);a.pingIntervalTimer=setTimeout(function(){d("writing ping packet - expecting pong within %sms",a.pingTimeout);
a.ping();a.onHeartbeat(a.pingTimeout)},a.pingInterval)};a.prototype.ping=function(){this.sendPacket("ping")};a.prototype.onDrain=function(){for(var a=0;a<this.prevBufferLen;a++)if(this.callbackBuffer[a])this.callbackBuffer[a]();this.writeBuffer.splice(0,this.prevBufferLen);this.callbackBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;0==this.writeBuffer.length?this.emit("drain"):this.flush()};a.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&
this.writeBuffer.length&&(d("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))};a.prototype.write=a.prototype.send=function(a,b){this.sendPacket("message",a,b);return this};a.prototype.sendPacket=function(a,b,c){"closing"!=this.readyState&&"closed"!=this.readyState&&(a={type:a,data:b},this.emit("packetCreate",a),this.writeBuffer.push(a),this.callbackBuffer.push(c),this.flush())};a.prototype.close=
function(){if("opening"==this.readyState||"open"==this.readyState){var a=function(){e.once("upgrade",b);e.once("upgradeError",b)},b=function(){e.removeListener("upgrade",b);e.removeListener("upgradeError",b);c()},c=function(){e.onClose("forced close");d("socket closing - telling transport to close");e.transport.close()};this.readyState="closing";var e=this;if(this.writeBuffer.length)this.once("drain",function(){this.upgrading?a():c()});else this.upgrading?a():c()}return this};a.prototype.onError=
function(b){d("socket error %j",b);a.priorWebsocketSuccess=!1;this.emit("error",b);this.onClose("transport error",b)};a.prototype.onClose=function(a,b){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){d('socket close with reason: "%s"',a);var c=this;clearTimeout(this.pingIntervalTimer);clearTimeout(this.pingTimeoutTimer);setTimeout(function(){c.writeBuffer=[];c.callbackBuffer=[];c.prevBufferLen=0},0);this.transport.removeAllListeners("close");this.transport.close();
this.transport.removeAllListeners();this.readyState="closed";this.id=null;this.emit("close",a,b)}};a.prototype.filterUpgrades=function(a){for(var b=[],c=0,d=a.length;c<d;c++)~m(this.transports,a[c])&&b.push(a[c]);return b}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./transport":14,"./transports":15,"component-emitter":9,debug:22,"engine.io-parser":25,indexof:42,parsejson:34,parseqs:35,parseuri:36}],14:[function(f,h,g){function c(a){this.path=a.path;this.hostname=
a.hostname;this.port=a.port;this.secure=a.secure;this.query=a.query;this.timestampParam=a.timestampParam;this.timestampRequests=a.timestampRequests;this.readyState="";this.agent=a.agent||!1;this.socket=a.socket;this.enablesXDR=a.enablesXDR;this.pfx=a.pfx;this.key=a.key;this.passphrase=a.passphrase;this.cert=a.cert;this.ca=a.ca;this.ciphers=a.ciphers;this.rejectUnauthorized=a.rejectUnauthorized}var a=f("engine.io-parser");f=f("component-emitter");h.exports=c;f(c.prototype);c.timestamps=0;c.prototype.onError=
function(a,c){a=Error(a);a.type="TransportError";a.description=c;this.emit("error",a);return this};c.prototype.open=function(){if("closed"==this.readyState||""==this.readyState)this.readyState="opening",this.doOpen();return this};c.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.doClose(),this.onClose();return this};c.prototype.send=function(a){if("open"==this.readyState)this.write(a);else throw Error("Transport not open");};c.prototype.onOpen=function(){this.readyState=
"open";this.writable=!0;this.emit("open")};c.prototype.onData=function(b){b=a.decodePacket(b,this.socket.binaryType);this.onPacket(b)};c.prototype.onPacket=function(a){this.emit("packet",a)};c.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},{"component-emitter":9,"engine.io-parser":25}],15:[function(f,h,g){(function(c){var a=f("xmlhttprequest"),b=f("./polling-xhr"),e=f("./polling-jsonp"),d=f("./websocket");g.polling=function(d){var n=!1,f=!1,g=!1!==d.jsonp;c.location&&(f=
"https:"==location.protocol,(n=location.port)||(n=f?443:80),n=d.hostname!=location.hostname||n!=d.port,f=d.secure!=f);d.xdomain=n;d.xscheme=f;if("open"in new a(d)&&!d.forceJSONP)return new b(d);if(!g)throw Error("JSONP disabled");return new e(d)};g.websocket=d}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(f,h,g){(function(c){function a(){}function b(b){e.call(this,b);this.query=
this.query||{};x||(c.___eio||(c.___eio=[]),x=c.___eio);this.index=x.length;var d=this;x.push(function(a){d.onData(a)});this.query.j=this.index;c.document&&c.addEventListener&&c.addEventListener("beforeunload",function(){d.script&&(d.script.onerror=a)},!1)}var e=f("./polling"),d=f("component-inherit");h.exports=b;var g=/\n/g,n=/\\n/g,x;d(b,e);b.prototype.supportsBinary=!1;b.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);this.form&&(this.form.parentNode.removeChild(this.form),
this.iframe=this.form=null);e.prototype.doClose.call(this)};b.prototype.doPoll=function(){var a=this,b=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);b.async=!0;b.src=this.uri();b.onerror=function(b){a.onError("jsonp poll error",b)};var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c);this.script=b;"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var a=document.createElement("iframe");
document.body.appendChild(a);document.body.removeChild(a)},100)};b.prototype.doWrite=function(a,b){function c(){d();b()}function d(){if(e.iframe)try{e.form.removeChild(e.iframe)}catch(J){e.onError("jsonp polling iframe removal error",J)}try{I=document.createElement('\x3ciframe src\x3d"javascript:0" name\x3d"'+e.iframeId+'"\x3e')}catch(J){I=document.createElement("iframe"),I.name=e.iframeId,I.src="javascript:0"}I.id=e.iframeId;e.form.appendChild(I);e.iframe=I}var e=this;if(!this.form){var f=document.createElement("form"),
m=document.createElement("textarea"),x=this.iframeId="eio_iframe_"+this.index,I;f.className="socketio";f.style.position="absolute";f.style.top="-1000px";f.style.left="-1000px";f.target=x;f.method="POST";f.setAttribute("accept-charset","utf-8");m.name="d";f.appendChild(m);document.body.appendChild(f);this.form=f;this.area=m}this.form.action=this.uri();d();a=a.replace(n,"\\\n");this.area.value=a.replace(g,"\\n");try{this.form.submit()}catch(J){}this.iframe.attachEvent?this.iframe.onreadystatechange=
function(){"complete"==e.iframe.readyState&&c()}:this.iframe.onload=c}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./polling":18,"component-inherit":21}],17:[function(f,h,g){(function(c){function a(){}function b(a){n.call(this,a);if(c.location){var b="https:"==location.protocol,d=location.port;d||(d=b?443:80);this.xd=a.hostname!=c.location.hostname||d!=a.port;this.xs=a.secure!=b}}function e(a){this.method=a.method||"GET";this.uri=a.uri;this.xd=!!a.xd;this.xs=
!!a.xs;this.async=!1!==a.async;this.data=void 0!=a.data?a.data:null;this.agent=a.agent;this.isBinary=a.isBinary;this.supportsBinary=a.supportsBinary;this.enablesXDR=a.enablesXDR;this.pfx=a.pfx;this.key=a.key;this.passphrase=a.passphrase;this.cert=a.cert;this.ca=a.ca;this.ciphers=a.ciphers;this.rejectUnauthorized=a.rejectUnauthorized;this.create()}function d(){for(var a in e.requests)e.requests.hasOwnProperty(a)&&e.requests[a].abort()}var g=f("xmlhttprequest"),n=f("./polling"),x=f("component-emitter"),
u=f("component-inherit"),v=f("debug")("engine.io-client:polling-xhr");h.exports=b;h.exports.Request=e;u(b,n);b.prototype.supportsBinary=!0;b.prototype.request=function(a){a=a||{};a.uri=this.uri();a.xd=this.xd;a.xs=this.xs;a.agent=this.agent||!1;a.supportsBinary=this.supportsBinary;a.enablesXDR=this.enablesXDR;a.pfx=this.pfx;a.key=this.key;a.passphrase=this.passphrase;a.cert=this.cert;a.ca=this.ca;a.ciphers=this.ciphers;a.rejectUnauthorized=this.rejectUnauthorized;return new e(a)};b.prototype.doWrite=
function(a,b){a=this.request({method:"POST",data:a,isBinary:"string"!==typeof a&&void 0!==a});var c=this;a.on("success",b);a.on("error",function(a){c.onError("xhr post error",a)});this.sendXhr=a};b.prototype.doPoll=function(){v("xhr poll");var a=this.request(),b=this;a.on("data",function(a){b.onData(a)});a.on("error",function(a){b.onError("xhr poll error",a)});this.pollXhr=a};x(e.prototype);e.prototype.create=function(){var a={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};
a.pfx=this.pfx;a.key=this.key;a.passphrase=this.passphrase;a.cert=this.cert;a.ca=this.ca;a.ciphers=this.ciphers;a.rejectUnauthorized=this.rejectUnauthorized;var b=this.xhr=new g(a),d=this;try{v("xhr open %s: %s",this.method,this.uri);b.open(this.method,this.uri,this.async);this.supportsBinary&&(b.responseType="arraybuffer");if("POST"==this.method)try{this.isBinary?b.setRequestHeader("Content-type","application/octet-stream"):b.setRequestHeader("Content-type","text/plain;charset\x3dUTF-8")}catch(r){}"withCredentials"in
b&&(b.withCredentials=!0);this.hasXDR()?(b.onload=function(){d.onLoad()},b.onerror=function(){d.onError(b.responseText)}):b.onreadystatechange=function(){if(4==b.readyState)if(200==b.status||1223==b.status)d.onLoad();else setTimeout(function(){d.onError(b.status)},0)};v("xhr data %s",this.data);b.send(this.data)}catch(r){setTimeout(function(){d.onError(r)},0);return}c.document&&(this.index=e.requestsCount++,e.requests[this.index]=this)};e.prototype.onSuccess=function(){this.emit("success");this.cleanup()};
e.prototype.onData=function(a){this.emit("data",a);this.onSuccess()};e.prototype.onError=function(a){this.emit("error",a);this.cleanup(!0)};e.prototype.cleanup=function(b){if("undefined"!=typeof this.xhr&&null!==this.xhr){this.hasXDR()?this.xhr.onload=this.xhr.onerror=a:this.xhr.onreadystatechange=a;if(b)try{this.xhr.abort()}catch(w){}c.document&&delete e.requests[this.index];this.xhr=null}};e.prototype.onLoad=function(){try{try{var a=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(E){}var b=
"application/octet-stream"===a?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(E){this.onError(E)}if(null!=b)this.onData(b)};e.prototype.hasXDR=function(){return"undefined"!==typeof c.XDomainRequest&&!this.xs&&this.enablesXDR};e.prototype.abort=function(){this.cleanup()};c.document&&(e.requestsCount=0,e.requests={},c.attachEvent?c.attachEvent("onunload",d):c.addEventListener&&c.addEventListener("beforeunload",d,!1))}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?
window:{})},{"./polling":18,"component-emitter":9,"component-inherit":21,debug:22,xmlhttprequest:20}],18:[function(f,h,g){function c(b){var c=b&&b.forceBase64;if(!m||c)this.supportsBinary=!1;a.call(this,b)}var a=f("../transport"),b=f("parseqs"),e=f("engine.io-parser");g=f("component-inherit");var d=f("debug")("engine.io-client:polling");h.exports=c;var m=null!=(new (f("xmlhttprequest"))({xdomain:!1})).responseType;g(c,a);c.prototype.name="polling";c.prototype.doOpen=function(){this.poll()};c.prototype.pause=
function(a){function b(){d("paused");c.readyState="paused";a()}var c=this;this.readyState="pausing";if(this.polling||!this.writable){var e=0;this.polling&&(d("we are currently polling - waiting to pause"),e++,this.once("pollComplete",function(){d("pre-pause polling complete");--e||b()}));this.writable||(d("we are currently writing - waiting to pause"),e++,this.once("drain",function(){d("pre-pause writing complete");--e||b()}))}else b()};c.prototype.poll=function(){d("polling");this.polling=!0;this.doPoll();
this.emit("poll")};c.prototype.onData=function(a){var b=this;d("polling got data %s",a);e.decodePayload(a,this.socket.binaryType,function(a,c,d){if("opening"==b.readyState)b.onOpen();if("close"==a.type)return b.onClose(),!1;b.onPacket(a)});"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():d('ignoring poll - transport state "%s"',this.readyState))};c.prototype.doClose=function(){function a(){d("writing close packet");b.write([{type:"close"}])}
var b=this;"open"==this.readyState?(d("transport open - closing"),a()):(d("transport not open - deferring close"),this.once("open",a))};c.prototype.write=function(a){var b=this;this.writable=!1;var c=function(){b.writable=!0;b.emit("drain")};b=this;e.encodePayload(a,this.supportsBinary,function(a){b.doWrite(a,c)})};c.prototype.uri=function(){var c=this.query||{},d=this.secure?"https":"http",e="";!1!==this.timestampRequests&&(c[this.timestampParam]=+new Date+"-"+a.timestamps++);this.supportsBinary||
c.sid||(c.b64=1);c=b.encode(c);this.port&&("https"==d&&443!=this.port||"http"==d&&80!=this.port)&&(e=":"+this.port);c.length&&(c="?"+c);return d+"://"+this.hostname+e+this.path+c}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,xmlhttprequest:20}],19:[function(f,h,g){function c(b){b&&b.forceBase64&&(this.supportsBinary=!1);a.call(this,b)}var a=f("../transport"),b=f("engine.io-parser"),e=f("parseqs");g=f("component-inherit");var d=f("debug")("engine.io-client:websocket"),
m=f("ws");h.exports=c;g(c,a);c.prototype.name="websocket";c.prototype.supportsBinary=!0;c.prototype.doOpen=function(){if(this.check()){var a=this.uri(),b={agent:this.agent};b.pfx=this.pfx;b.key=this.key;b.passphrase=this.passphrase;b.cert=this.cert;b.ca=this.ca;b.ciphers=this.ciphers;b.rejectUnauthorized=this.rejectUnauthorized;this.ws=new m(a,void 0,b);void 0===this.ws.binaryType&&(this.supportsBinary=!1);this.ws.binaryType="arraybuffer";this.addEventListeners()}};c.prototype.addEventListeners=function(){var a=
this;this.ws.onopen=function(){a.onOpen()};this.ws.onclose=function(){a.onClose()};this.ws.onmessage=function(b){a.onData(b.data)};this.ws.onerror=function(b){a.onError("websocket error",b)}};"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(c.prototype.onData=function(b){var c=this;setTimeout(function(){a.prototype.onData.call(c,b)},0)});c.prototype.write=function(a){var c=this;this.writable=!1;for(var e=0,f=a.length;e<f;e++)b.encodePacket(a[e],this.supportsBinary,function(a){try{c.ws.send(a)}catch(w){d("websocket closed before onclose event")}});
setTimeout(function(){c.writable=!0;c.emit("drain")},0)};c.prototype.onClose=function(){a.prototype.onClose.call(this)};c.prototype.doClose=function(){"undefined"!==typeof this.ws&&this.ws.close()};c.prototype.uri=function(){var a=this.query||{},b=this.secure?"wss":"ws",c="";this.port&&("wss"==b&&443!=this.port||"ws"==b&&80!=this.port)&&(c=":"+this.port);this.timestampRequests&&(a[this.timestampParam]=+new Date);this.supportsBinary||(a.b64=1);a=e.encode(a);a.length&&(a="?"+a);return b+"://"+this.hostname+
c+this.path+a};c.prototype.check=function(){return!!m&&!("__initialize"in m&&this.name===c.prototype.name)}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,ws:37}],20:[function(f,h,g){var c=f("has-cors");h.exports=function(a){var b=a.xdomain,e=a.xscheme;a=a.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!b||c))return new XMLHttpRequest}catch(d){}try{if("undefined"!=typeof XDomainRequest&&!e&&a)return new XDomainRequest}catch(d){}if(!b)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(d){}}},
{"has-cors":40}],21:[function(f,h,g){h.exports=function(c,a){var b=function(){};b.prototype=a.prototype;c.prototype=new b;c.prototype.constructor=c}},{}],22:[function(f,h,g){function c(){try{var a=localStorage.debug}catch(b){}return a}g=h.exports=f("./debug");g.log=function(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)};g.formatArgs=function(){var a=arguments,b=this.useColors;a[0]=(b?"%c":"")+this.namespace+(b?" %c":
" ")+a[0]+(b?"%c ":" ")+"+"+g.humanize(this.diff);if(!b)return a;b="color: "+this.color;a=[a[0],b,"color: inherit"].concat(Array.prototype.slice.call(a,1));var c=0,d=0;a[0].replace(/%[a-z%]/g,function(a){"%"!==a&&(c++,"%c"===a&&(d=c))});a.splice(d,0,b);return a};g.save=function(a){try{null==a?localStorage.removeItem("debug"):localStorage.debug=a}catch(b){}};g.load=c;g.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&
console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)};g.colors="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" ");g.formatters.j=function(a){return JSON.stringify(a)};g.enable(c())},{"./debug":23}],23:[function(f,h,g){g=h.exports=function(b){function e(){}function d(){var b=+new Date;d.diff=b-(a||b);d.prev=a;a=d.curr=b;null==d.useColors&&(d.useColors=g.useColors());null==d.color&&d.useColors&&(d.color=g.colors[c++%g.colors.length]);
var e=Array.prototype.slice.call(arguments);e[0]=g.coerce(e[0]);"string"!==typeof e[0]&&(e=["%o"].concat(e));var f=0;e[0]=e[0].replace(/%([a-z%])/g,function(a,b){if("%"===a)return a;f++;b=g.formatters[b];"function"===typeof b&&(a=b.call(d,e[f]),e.splice(f,1),f--);return a});"function"===typeof g.formatArgs&&(e=g.formatArgs.apply(d,e));(d.log||g.log||console.log.bind(console)).apply(d,e)}e.enabled=!1;d.enabled=!0;var f=g.enabled(b)?d:e;f.namespace=b;return f};g.coerce=function(a){return a instanceof
Error?a.stack||a.message:a};g.disable=function(){g.enable("")};g.enable=function(a){g.save(a);for(var b=(a||"").split(/[\s,]+/),c=b.length,f=0;f<c;f++)b[f]&&(a=b[f].replace(/\*/g,".*?"),"-"===a[0]?g.skips.push(new RegExp("^"+a.substr(1)+"$")):g.names.push(new RegExp("^"+a+"$")))};g.enabled=function(a){var b;var c=0;for(b=g.skips.length;c<b;c++)if(g.skips[c].test(a))return!1;c=0;for(b=g.names.length;c<b;c++)if(g.names[c].test(a))return!0;return!1};g.humanize=f("ms");g.names=[];g.skips=[];g.formatters=
{};var c=0,a},{ms:24}],24:[function(f,h,g){function c(a){if(a=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(a)){var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case "years":case "year":case "y":return c*e;case "days":case "day":case "d":return c*b;case "hours":case "hour":case "h":return 36E5*c;case "minutes":case "minute":case "m":return 6E4*c;case "seconds":case "second":case "s":return 1E3*c;case "ms":return c}}}function a(a,b,c){if(!(a<b))return a<
1.5*b?Math.floor(a/b)+" "+c:Math.ceil(a/b)+" "+c+"s"}var b=864E5,e=365.25*b;h.exports=function(d,e){e=e||{};return"string"==typeof d?c(d):e.long?a(d,b,"day")||a(d,36E5,"hour")||a(d,6E4,"minute")||a(d,1E3,"second")||d+" ms":d>=b?Math.round(d/b)+"d":36E5<=d?Math.round(d/36E5)+"h":6E4<=d?Math.round(d/6E4)+"m":1E3<=d?Math.round(d/1E3)+"s":d+"ms"}},{}],25:[function(f,h,g){(function(c){function a(a,b,c){if(!b)return g.encodeBase64Packet(a,c);var d=new FileReader;d.onload=function(){a.data=d.result;g.encodePacket(a,
b,!0,c)};return d.readAsArrayBuffer(a.data)}function b(a,b,c){var d=Array(a.length);c=h(a.length,c);for(var e=function(a,c,e){b(c,function(b,c){d[a]=c;e(b,d)})},f=0;f<a.length;f++)e(f,a[f],c)}var e=f("./keys"),d=f("has-binary"),m=f("arraybuffer.slice"),n=f("base64-arraybuffer"),h=f("after"),u=f("utf8"),v=navigator.userAgent.match(/Android/i),y=/PhantomJS/i.test(navigator.userAgent),w=v||y;g.protocol=3;var E=g.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},r=e(E),C={type:"error",
data:"parser error"},B=f("blob");g.encodePacket=function(b,d,e,f){"function"==typeof d&&(f=d,d=!1);"function"==typeof e&&(f=e,e=null);var r=void 0===b.data?void 0:b.data.buffer||b.data;if(c.ArrayBuffer&&r instanceof ArrayBuffer){if(d){e=b.data;d=new Uint8Array(e);e=new Uint8Array(1+e.byteLength);e[0]=E[b.type];for(b=0;b<d.length;b++)e[b+1]=d[b];b=f(e.buffer)}else b=g.encodeBase64Packet(b,f);return b}if(B&&r instanceof c.Blob)return d?w?b=a(b,d,f):(d=new Uint8Array(1),d[0]=E[b.type],b=new B([d.buffer,
b.data]),b=f(b)):b=g.encodeBase64Packet(b,f),b;if(r&&r.base64)return f("b"+g.packets[b.type]+b.data.data);d=E[b.type];void 0!==b.data&&(d+=e?u.encode(String(b.data)):String(b.data));return f(""+d)};g.encodeBase64Packet=function(a,b){var d="b"+g.packets[a.type];if(B&&a.data instanceof B){var e=new FileReader;e.onload=function(){var a=e.result.split(",")[1];b(d+a)};return e.readAsDataURL(a.data)}try{var f=String.fromCharCode.apply(null,new Uint8Array(a.data))}catch(l){a=new Uint8Array(a.data);f=Array(a.length);
for(var r=0;r<a.length;r++)f[r]=a[r];f=String.fromCharCode.apply(null,f)}d+=c.btoa(f);return b(d)};g.decodePacket=function(a,b,c){if("string"==typeof a||void 0===a){if("b"==a.charAt(0))return g.decodeBase64Packet(a.substr(1),b);if(c)try{a=u.decode(a)}catch(F){return C}c=a.charAt(0);return Number(c)==c&&r[c]?1<a.length?{type:r[c],data:a.substring(1)}:{type:r[c]}:C}c=(new Uint8Array(a))[0];a=m(a,1);B&&"blob"===b&&(a=new B([a]));return{type:r[c],data:a}};g.decodeBase64Packet=function(a,b){var d=r[a.charAt(0)];
if(!c.ArrayBuffer)return{type:d,data:{base64:!0,data:a.substr(1)}};a=n.decode(a.substr(1));"blob"===b&&B&&(a=new B([a]));return{type:d,data:a}};g.encodePayload=function(a,c,e){"function"==typeof c&&(e=c,c=null);var f=d(a);if(c&&f)return B&&!w?g.encodePayloadAsBlob(a,e):g.encodePayloadAsArrayBuffer(a,e);if(!a.length)return e("0:");b(a,function(a,b){g.encodePacket(a,f?c:!1,!0,function(a){b(null,a.length+":"+a)})},function(a,b){return e(b.join(""))})};g.decodePayload=function(a,b,c){if("string"!=typeof a)return g.decodePayloadAsBinary(a,
b,c);"function"===typeof b&&(c=b,b=null);if(""==a)return c(C,0,1);var d="";for(var e,f,r=0,m=a.length;r<m;r++)if(f=a.charAt(r),":"!=f)d+=f;else{if(""==d||d!=(e=Number(d)))return c(C,0,1);f=a.substr(r+1,e);if(d!=f.length)return c(C,0,1);if(f.length){d=g.decodePacket(f,b,!0);if(C.type==d.type&&C.data==d.data)return c(C,0,1);if(!1===c(d,r+e,m))return}r+=e;d=""}if(""!=d)return c(C,0,1)};g.encodePayloadAsArrayBuffer=function(a,c){if(!a.length)return c(new ArrayBuffer(0));b(a,function(a,b){g.encodePacket(a,
!0,!0,function(a){return b(null,a)})},function(a,b){a=b.reduce(function(a,b){b="string"===typeof b?b.length:b.byteLength;return a+b.toString().length+b+2},0);var d=new Uint8Array(a),e=0;b.forEach(function(a){var b="string"===typeof a,c=a;if(b){c=new Uint8Array(a.length);for(var f=0;f<a.length;f++)c[f]=a.charCodeAt(f);c=c.buffer}b?d[e++]=0:d[e++]=1;a=c.byteLength.toString();for(f=0;f<a.length;f++)d[e++]=parseInt(a[f]);d[e++]=255;c=new Uint8Array(c);for(f=0;f<c.length;f++)d[e++]=c[f]});return c(d.buffer)})};
g.encodePayloadAsBlob=function(a,c){b(a,function(a,b){g.encodePacket(a,!0,!0,function(a){var c=new Uint8Array(1);c[0]=1;if("string"===typeof a){for(var d=new Uint8Array(a.length),e=0;e<a.length;e++)d[e]=a.charCodeAt(e);a=d.buffer;c[0]=0}d=(a instanceof ArrayBuffer?a.byteLength:a.size).toString();var f=new Uint8Array(d.length+1);for(e=0;e<d.length;e++)f[e]=parseInt(d[e]);f[d.length]=255;B&&(a=new B([c.buffer,f.buffer,a]),b(null,a))})},function(a,b){return c(new B(b))})};g.decodePayloadAsBinary=function(a,
b,c){"function"===typeof b&&(c=b,b=null);for(var d=[],e=!1;0<a.byteLength;){for(var f=new Uint8Array(a),r=0===f[0],n="",k=1;255!=f[k];k++){if(310<n.length){e=!0;break}n+=f[k]}if(e)return c(C,0,1);a=m(a,2+n.length);n=parseInt(n);f=m(a,0,n);if(r)try{f=String.fromCharCode.apply(null,new Uint8Array(f))}catch(t){for(r=new Uint8Array(f),f="",k=0;k<r.length;k++)f+=String.fromCharCode(r[k])}d.push(f);a=m(a,n)}var h=d.length;d.forEach(function(a,d){c(g.decodePacket(a,b,!0),d,h)})}}).call(this,"undefined"!==
typeof self?self:"undefined"!==typeof window?window:{})},{"./keys":26,after:27,"arraybuffer.slice":28,"base64-arraybuffer":29,blob:30,"has-binary":31,utf8:33}],26:[function(f,h,g){h.exports=Object.keys||function(c){var a=[],b=Object.prototype.hasOwnProperty,e;for(e in c)b.call(c,e)&&a.push(e);return a}},{}],27:[function(f,h,g){function c(){}h.exports=function(a,b,e){function d(a,c){if(0>=d.count)throw Error("after called too many times");--d.count;a?(f=!0,b(a),b=e):0!==d.count||f||b(null,c)}var f=
!1;e=e||c;d.count=a;return 0===a?b():d}},{}],28:[function(f,h,g){h.exports=function(c,a,b){var e=c.byteLength;a=a||0;b=b||e;if(c.slice)return c.slice(a,b);0>a&&(a+=e);0>b&&(b+=e);b>e&&(b=e);if(a>=e||a>=b||0===e)return new ArrayBuffer(0);c=new Uint8Array(c);e=new Uint8Array(b-a);for(var d=0;a<b;a++,d++)e[d]=c[a];return e.buffer}},{}],29:[function(f,h,g){(function(c){g.encode=function(a){a=new Uint8Array(a);var b,e=a.length,d="";for(b=0;b<e;b+=3)d+=c[a[b]>>2],d+=c[(a[b]&3)<<4|a[b+1]>>4],d+=c[(a[b+1]&
15)<<2|a[b+2]>>6],d+=c[a[b+2]&63];2===e%3?d=d.substring(0,d.length-1)+"\x3d":1===e%3&&(d=d.substring(0,d.length-2)+"\x3d\x3d");return d};g.decode=function(a){var b=.75*a.length,e=a.length,d=0;"\x3d"===a[a.length-1]&&(b--,"\x3d"===a[a.length-2]&&b--);var f=new ArrayBuffer(b),g=new Uint8Array(f);for(b=0;b<e;b+=4){var h=c.indexOf(a[b]);var u=c.indexOf(a[b+1]);var v=c.indexOf(a[b+2]);var y=c.indexOf(a[b+3]);g[d++]=h<<2|u>>4;g[d++]=(u&15)<<4|v>>2;g[d++]=(v&3)<<6|y&63}return f}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},
{}],30:[function(f,h,g){(function(c){function a(a,c){c=c||{};for(var d=new b,e=0;e<a.length;e++)d.append(a[e]);return c.type?d.getBlob(c.type):d.getBlob()}var b=c.BlobBuilder||c.WebKitBlobBuilder||c.MSBlobBuilder||c.MozBlobBuilder;try{var e=2==(new Blob(["hi"])).size}catch(m){e=!1}var d=b&&b.prototype.append&&b.prototype.getBlob;c=e?c.Blob:d?a:void 0;h.exports=c}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],31:[function(f,h,g){(function(c){var a=f("isarray");
h.exports=function(b){function e(b){if(!b)return!1;if(c.Buffer&&c.Buffer.isBuffer(b)||c.ArrayBuffer&&b instanceof ArrayBuffer||c.Blob&&b instanceof Blob||c.File&&b instanceof File)return!0;if(a(b))for(var d=0;d<b.length;d++){if(e(b[d]))return!0}else if(b&&"object"==typeof b)for(d in b.toJSON&&(b=b.toJSON()),b)if(b.hasOwnProperty(d)&&e(b[d]))return!0;return!1}return e(b)}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{isarray:32}],32:[function(f,h,g){h.exports=
Array.isArray||function(c){return"[object Array]"==Object.prototype.toString.call(c)}},{}],33:[function(f,h,g){(function(c){(function(a){function b(a){for(var b=[],c=0,d=a.length,e,f;c<d;)e=a.charCodeAt(c++),55296<=e&&56319>=e&&c<d?(f=a.charCodeAt(c++),56320==(f&64512)?b.push(((e&1023)<<10)+(f&1023)+65536):(b.push(e),c--)):b.push(e);return b}function e(){if(w>=y)throw Error("Invalid byte index");var a=v[w]&255;w++;if(128==(a&192))return a&63;throw Error("Invalid continuation byte");}function d(){if(w>
y)throw Error("Invalid byte index");if(w==y)return!1;var a=v[w]&255;w++;if(0==(a&128))return a;if(192==(a&224)){var b=e();a=(a&31)<<6|b;if(128<=a)return a;throw Error("Invalid continuation byte");}if(224==(a&240)){b=e();var c=e();a=(a&15)<<12|b<<6|c;if(2048<=a)return a;throw Error("Invalid continuation byte");}if(240==(a&248)){b=e();c=e();var d=e();a=(a&15)<<18|b<<12|c<<6|d;if(65536<=a&&1114111>=a)return a}throw Error("Invalid UTF-8 detected");}var f="object"==typeof g&&g,n="object"==typeof h&&h&&
h.exports==f&&h,x="object"==typeof c&&c;if(x.global===x||x.window===x)a=x;var u=String.fromCharCode,v,y,w;x={version:"2.0.0",encode:function(a){a=b(a);for(var c=a.length,d=-1,e,f="";++d<c;){e=a[d];if(0==(e&4294967168))e=u(e);else{var g="";0==(e&4294965248)?g=u(e>>6&31|192):0==(e&4294901760)?(g=u(e>>12&15|224),g+=u(e>>6&63|128)):0==(e&4292870144)&&(g=u(e>>18&7|240),g+=u(e>>12&63|128),g+=u(e>>6&63|128));e=g+=u(e&63|128)}f+=e}return f},decode:function(a){v=b(a);y=v.length;w=0;a=[];for(var c;!1!==(c=
d());)a.push(c);c=a.length;for(var e=-1,f,g="";++e<c;)f=a[e],65535<f&&(f-=65536,g+=u(f>>>10&1023|55296),f=56320|f&1023),g+=u(f);return g}};if(f&&!f.nodeType)if(n)n.exports=x;else{a={}.hasOwnProperty;for(var E in x)a.call(x,E)&&(f[E]=x[E])}else a.utf8=x})(this)}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],34:[function(f,h,g){(function(c){var a=/^[\],:{}\s]*$/,b=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,e=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
d=/(?:^|:|,)(?:\s*\[)+/g,f=/^\s+/,g=/\s+$/;h.exports=function(n){if("string"!=typeof n||!n)return null;n=n.replace(f,"").replace(g,"");if(c.JSON&&JSON.parse)return JSON.parse(n);if(a.test(n.replace(b,"@").replace(e,"]").replace(d,"")))return(new Function("return "+n))()}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],35:[function(f,h,g){g.encode=function(c){var a="",b;for(b in c)c.hasOwnProperty(b)&&(a.length&&(a+="\x26"),a+=encodeURIComponent(b)+"\x3d"+encodeURIComponent(c[b]));
return a};g.decode=function(c){var a={};c=c.split("\x26");for(var b=0,e=c.length;b<e;b++){var d=c[b].split("\x3d");a[decodeURIComponent(d[0])]=decodeURIComponent(d[1])}return a}},{}],36:[function(f,h,g){var c=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,a="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");
h.exports=function(b){var e=b,d=b.indexOf("["),f=b.indexOf("]");-1!=d&&-1!=f&&(b=b.substring(0,d)+b.substring(d,f).replace(/:/g,";")+b.substring(f,b.length));b=c.exec(b||"");for(var g={},h=14;h--;)g[a[h]]=b[h]||"";-1!=d&&-1!=f&&(g.source=e,g.host=g.host.substring(1,g.host.length-1).replace(/;/g,":"),g.authority=g.authority.replace("[","").replace("]","").replace(/;/g,":"),g.ipv6uri=!0);return g}},{}],37:[function(f,h,g){function c(b,c,d){return c?new a(b,c):new a(b)}f=function(){return this}();var a=
f.WebSocket||f.MozWebSocket;h.exports=a?c:null;a&&(c.prototype=a.prototype)},{}],38:[function(f,h,g){(function(c){var a=f("isarray");h.exports=function(b){function e(b){if(!b)return!1;if(c.Buffer&&c.Buffer.isBuffer(b)||c.ArrayBuffer&&b instanceof ArrayBuffer||c.Blob&&b instanceof Blob||c.File&&b instanceof File)return!0;if(a(b))for(var d=0;d<b.length;d++){if(e(b[d]))return!0}else if(b&&"object"==typeof b)for(d in b.toJSON&&(b=b.toJSON()),b)if(Object.prototype.hasOwnProperty.call(b,d)&&e(b[d]))return!0;
return!1}return e(b)}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{isarray:39}],39:[function(f,h,g){h.exports=f(32)},{}],40:[function(f,h,g){f=f("global");try{h.exports="XMLHttpRequest"in f&&"withCredentials"in new f.XMLHttpRequest}catch(c){h.exports=!1}},{global:41}],41:[function(f,h,g){h.exports=function(){return this}()},{}],42:[function(f,h,g){var c=[].indexOf;h.exports=function(a,b){if(c)return a.indexOf(b);for(var e=0;e<a.length;++e)if(a[e]===b)return e;
return-1}},{}],43:[function(f,h,g){var c=Object.prototype.hasOwnProperty;g.keys=Object.keys||function(a){var b=[],e;for(e in a)c.call(a,e)&&b.push(e);return b};g.values=function(a){var b=[],e;for(e in a)c.call(a,e)&&b.push(a[e]);return b};g.merge=function(a,b){for(var e in b)c.call(b,e)&&(a[e]=b[e]);return a};g.length=function(a){return g.keys(a).length};g.isEmpty=function(a){return 0==g.length(a)}},{}],44:[function(f,h,g){var c=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,
a="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");h.exports=function(b){b=c.exec(b||"");for(var e={},d=14;d--;)e[a[d]]=b[d]||"";return e}},{}],45:[function(f,h,g){(function(c){var a=f("isarray"),b=f("./is-buffer");g.deconstructPacket=function(c){function d(c){if(!c)return c;if(b(c)){var f={_placeholder:!0,num:e.length};e.push(c);return f}if(a(c)){f=Array(c.length);for(var g=0;g<c.length;g++)f[g]=d(c[g]);return f}if("object"==typeof c&&
!(c instanceof Date)){f={};for(g in c)f[g]=d(c[g]);return f}return c}var e=[];c.data=d(c.data);c.attachments=e.length;return{packet:c,buffers:e}};g.reconstructPacket=function(b,c){function d(b){if(b&&b._placeholder)return c[b.num];if(a(b))for(var e=0;e<b.length;e++)b[e]=d(b[e]);else if(b&&"object"==typeof b)for(e in b)b[e]=d(b[e]);return b}b.data=d(b.data);b.attachments=void 0;return b};g.removeBlobs=function(e,d){function f(e,n,m){if(!e)return e;if(c.Blob&&e instanceof Blob||c.File&&e instanceof
File){g++;var v=new FileReader;v.onload=function(){m?m[n]=this.result:h=this.result;--g||d(h)};v.readAsArrayBuffer(e)}else if(a(e))for(v=0;v<e.length;v++)f(e[v],v,e);else if(e&&"object"==typeof e&&!b(e))for(v in e)f(e[v],v,e)}var g=0,h=e;f(h);g||d(h)}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{"./is-buffer":47,isarray:48}],46:[function(f,h,g){function c(){}function a(a){var b=!1;var c=""+a.type;if(g.BINARY_EVENT==a.type||g.BINARY_ACK==a.type)c+=a.attachments,
c+="-";a.nsp&&"/"!=a.nsp&&(b=!0,c+=a.nsp);null!=a.id&&(b&&(c+=",",b=!1),c+=a.id);null!=a.data&&(b&&(c+=","),c+=n.stringify(a.data));m("encoded %j as %s",a,c);return c}function b(b,c){x.removeBlobs(b,function(b){var d=x.deconstructPacket(b);b=a(d.packet);d=d.buffers;d.unshift(b);c(d)})}function e(){this.reconstructor=null}function d(a){this.reconPack=a;this.buffers=[]}var m=f("debug")("socket.io-parser"),n=f("json3");f("isarray");h=f("component-emitter");var x=f("./binary"),u=f("./is-buffer");g.protocol=
4;g.types="CONNECT DISCONNECT EVENT BINARY_EVENT ACK BINARY_ACK ERROR".split(" ");g.CONNECT=0;g.DISCONNECT=1;g.EVENT=2;g.ACK=3;g.ERROR=4;g.BINARY_EVENT=5;g.BINARY_ACK=6;g.Encoder=c;g.Decoder=e;c.prototype.encode=function(c,d){m("encoding packet %j",c);g.BINARY_EVENT==c.type||g.BINARY_ACK==c.type?b(c,d):(c=a(c),d([c]))};h(e.prototype);e.prototype.add=function(a){if("string"==typeof a){a:{var b={},c=0;b.type=Number(a.charAt(0));if(null==g.types[b.type])a={type:g.ERROR,data:"parser error"};else{if(g.BINARY_EVENT==
b.type||g.BINARY_ACK==b.type){for(var e="";"-"!=a.charAt(++c)&&(e+=a.charAt(c),c!=a.length););if(e!=Number(e)||"-"!=a.charAt(c))throw Error("Illegal attachments");b.attachments=Number(e)}if("/"==a.charAt(c+1))for(b.nsp="";++c;){e=a.charAt(c);if(","==e)break;b.nsp+=e;if(c==a.length)break}else b.nsp="/";e=a.charAt(c+1);if(""!==e&&Number(e)==e){for(b.id="";++c;){e=a.charAt(c);if(null==e||Number(e)!=e){--c;break}b.id+=a.charAt(c);if(c==a.length)break}b.id=Number(b.id)}if(a.charAt(++c))try{b.data=n.parse(a.substr(c))}catch(r){a=
{type:g.ERROR,data:"parser error"};break a}m("decoded %s as %j",a,b);a=b}}g.BINARY_EVENT==a.type||g.BINARY_ACK==a.type?(this.reconstructor=new d(a),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",a)):this.emit("decoded",a)}else if(u(a)||a.base64)if(this.reconstructor){if(a=this.reconstructor.takeBinaryData(a))this.reconstructor=null,this.emit("decoded",a)}else throw Error("got binary data when not reconstructing a packet");else throw Error("Unknown type: "+a);};e.prototype.destroy=
function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};d.prototype.takeBinaryData=function(a){this.buffers.push(a);return this.buffers.length==this.reconPack.attachments?(a=x.reconstructPacket(this.reconPack,this.buffers),this.finishedReconstruction(),a):null};d.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]}},{"./binary":45,"./is-buffer":47,"component-emitter":9,debug:10,isarray:48,json3:49}],47:[function(f,h,g){(function(c){h.exports=function(a){return c.Buffer&&
c.Buffer.isBuffer(a)||c.ArrayBuffer&&a instanceof ArrayBuffer}}).call(this,"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},{}],48:[function(f,h,g){h.exports=f(32)},{}],49:[function(f,h,g){(function(c){function a(c){if(a[c]!==d)return a[c];if("bug-string-char-index"==c)var e=!1;else if("json"==c)e=a("json-stringify")&&a("json-parse");else{var f;if("json-stringify"==c){e=h.stringify;var g="function"==typeof e&&x;if(g){(f=function(){return 1}).toJSON=f;try{g="0"===e(0)&&"0"===
e(new Number)&&'""'==e(new String)&&e(b)===d&&e(d)===d&&e()===d&&"1"===e(f)&&"[1]"==e([f])&&"[null]"==e([d])&&"null"==e(null)&&"[null,null,null]"==e([d,b,null])&&'{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}'==e({a:[f,!0,!1,null,"\x00\b\n\f\r\t"]})&&"1"===e(null,f)&&"[\n 1,\n 2\n]"==e([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==e(new Date(-864E13))&&'"+275760-09-13T00:00:00.000Z"'==e(new Date(864E13))&&'"-000001-01-01T00:00:00.000Z"'==e(new Date(-621987552E5))&&'"1969-12-31T23:59:59.999Z"'==
e(new Date(-1))}catch(O){g=!1}}e=g}if("json-parse"==c){e=h.parse;if("function"==typeof e)try{if(0===e("0")&&!e(!1)){f=e('{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}');var r=5==f.a.length&&1===f.a[0];if(r){try{r=!e('"\t"')}catch(O){}if(r)try{r=1!==e("01")}catch(O){}if(r)try{r=1!==e("1.")}catch(O){}}}}catch(O){r=!1}e=r}}return a[c]=!!e}var b={}.toString,e,d,f="object"==typeof JSON&&JSON,h="object"==typeof g&&g&&!g.nodeType&&g;h&&f?(h.stringify=f.stringify,h.parse=f.parse):h=c.JSON=f||{};var x=
new Date(-0xc782b5b800cec);try{x=-109252==x.getUTCFullYear()&&0===x.getUTCMonth()&&1===x.getUTCDate()&&10==x.getUTCHours()&&37==x.getUTCMinutes()&&6==x.getUTCSeconds()&&708==x.getUTCMilliseconds()}catch(M){}if(!a("json")){var u=a("bug-string-char-index");if(!x)var v=Math.floor,y=[0,31,59,90,120,151,181,212,243,273,304,334],w=function(a,b){return y[b]+365*(a-1970)+v((a-1969+(b=+(1<b)))/4)-v((a-1901+b)/100)+v((a-1601+b)/400)};(e={}.hasOwnProperty)||(e=function(a){var c={};if((c.__proto__=null,c.__proto__=
{toString:1},c).toString!=b)e=function(a){var b=this.__proto__;a=a in(this.__proto__=null,this);this.__proto__=b;return a};else{var d=c.constructor;e=function(a){var b=(this.constructor||d).prototype;return a in this&&!(a in b&&this[a]===b[a])}}c=null;return e.call(this,a)});var E={"boolean":1,number:1,string:1,undefined:1};var r=function(a,c){var d=0,f,g;(f=function(){this.valueOf=0}).prototype.valueOf=0;var k=new f;for(g in k)e.call(k,g)&&d++;f=k=null;d?r=2==d?function(a,c){var d={},f="[object Function]"==
b.call(a),g;for(g in a)f&&"prototype"==g||e.call(d,g)||!(d[g]=1)||!e.call(a,g)||c(g)}:function(a,c){var d="[object Function]"==b.call(a),f,g;for(f in a)d&&"prototype"==f||!e.call(a,f)||(g="constructor"===f)||c(f);(g||e.call(a,f="constructor"))&&c(f)}:(k="valueOf toString toLocaleString propertyIsEnumerable isPrototypeOf hasOwnProperty constructor".split(" "),r=function(a,c){var d="[object Function]"==b.call(a),f,g;if(g=!d&&"function"!=typeof a.constructor)g=typeof a.hasOwnProperty,g="object"==g?!!a.hasOwnProperty:
!E[g];g=g?a.hasOwnProperty:e;for(f in a)d&&"prototype"==f||!g.call(a,f)||c(f);for(d=k.length;f=k[--d];g.call(a,f)&&c(f));});return r(a,c)};if(!a("json-stringify")){var C={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},B=function(a,b){return("000000"+(b||0)).slice(-a)},I=function(a){var b='"',c=0,e=a.length,d=10<e&&u,f;for(d&&(f=a.split(""));c<e;c++){var g=a.charCodeAt(c);switch(g){case 8:case 9:case 10:case 12:case 13:case 34:case 92:b+=C[g];break;default:b=32>g?b+("\\u00"+B(2,g.toString(16))):
b+(d?f[c]:u?a.charAt(c):a[c])}}return b+'"'},J=function(a,c,f,g,k,l,h){var H;try{var A=c[a]}catch(Q){}if("object"==typeof A&&A){var D=b.call(A);if("[object Date]"!=D||e.call(A,"toJSON"))"function"==typeof A.toJSON&&("[object Number]"!=D&&"[object String]"!=D&&"[object Array]"!=D||e.call(A,"toJSON"))&&(A=A.toJSON(a));else if(A>-1/0&&A<1/0){if(w){var C=v(A/864E5);for(D=v(C/365.2425)+1970-1;w(D+1,0)<=C;D++);for(H=v((C-w(D,0))/30.42);w(D,H+1)<=C;H++);C=1+C-w(D,H);var m=(A%864E5+864E5)%864E5;var n=v(m/
36E5)%24;var p=v(m/6E4)%60;var M=v(m/1E3)%60;m%=1E3}else D=A.getUTCFullYear(),H=A.getUTCMonth(),C=A.getUTCDate(),n=A.getUTCHours(),p=A.getUTCMinutes(),M=A.getUTCSeconds(),m=A.getUTCMilliseconds();A=(0>=D||1E4<=D?(0>D?"-":"+")+B(6,0>D?-D:D):B(4,D))+"-"+B(2,H+1)+"-"+B(2,C)+"T"+B(2,n)+":"+B(2,p)+":"+B(2,M)+"."+B(3,m)+"Z"}else A=null}f&&(A=f.call(c,a,A));if(null===A)return"null";D=b.call(A);if("[object Boolean]"==D)return""+A;if("[object Number]"==D)return A>-1/0&&A<1/0?""+A:"null";if("[object String]"==
D)return I(""+A);if("object"==typeof A){for(a=h.length;a--;)if(h[a]===A)throw TypeError();h.push(A);var K=[];c=l;l+=k;if("[object Array]"==D){H=0;for(a=A.length;H<a;H++)D=J(H,A,f,g,k,l,h),K.push(D===d?"null":D);a=K.length?k?"[\n"+l+K.join(",\n"+l)+"\n"+c+"]":"["+K.join(",")+"]":"[]"}else r(g||A,function(a){var b=J(a,A,f,g,k,l,h);b!==d&&K.push(I(a)+":"+(k?" ":"")+b)}),a=K.length?k?"{\n"+l+K.join(",\n"+l)+"\n"+c+"}":"{"+K.join(",")+"}":"{}";h.pop();return a}};h.stringify=function(a,c,e){var d;if("function"==
typeof c||"object"==typeof c&&c)if("[object Function]"==(d=b.call(c)))var f=c;else if("[object Array]"==d){var g={};for(var r=0,k=c.length,l;r<k;l=c[r++],(d=b.call(l),"[object String]"==d||"[object Number]"==d)&&(g[l]=1));}if(e)if("[object Number]"==(d=b.call(e))){if(0<(e-=e%1)){var H="";for(10<e&&(e=10);H.length<e;H+=" ");}}else"[object String]"==d&&(H=10>=e.length?e:e.slice(0,10));return J("",(l={},l[""]=a,l),f,g,H,"",[])}}if(!a("json-parse")){var P=String.fromCharCode,F={92:"\\",34:'"',47:"/",
98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},p,L,l=function(){p=L=null;throw SyntaxError();},z=function(){for(var a=L,b=a.length,c,e,d,f,g;p<b;)switch(g=a.charCodeAt(p),g){case 9:case 10:case 13:case 32:p++;break;case 123:case 125:case 91:case 93:case 58:case 44:return c=u?a.charAt(p):a[p],p++,c;case 34:c="@";for(p++;p<b;)if(g=a.charCodeAt(p),32>g)l();else if(92==g)switch(g=a.charCodeAt(++p),g){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:c+=F[g];p++;break;case 117:e=++p;for(d=
p+4;p<d;p++)g=a.charCodeAt(p),48<=g&&57>=g||97<=g&&102>=g||65<=g&&70>=g||l();c+=P("0x"+a.slice(e,p));break;default:l()}else{if(34==g)break;g=a.charCodeAt(p);for(e=p;32<=g&&92!=g&&34!=g;)g=a.charCodeAt(++p);c+=a.slice(e,p)}if(34==a.charCodeAt(p))return p++,c;l();default:e=p;45==g&&(f=!0,g=a.charCodeAt(++p));if(48<=g&&57>=g){for(48==g&&(g=a.charCodeAt(p+1),48<=g&&57>=g)&&l();p<b&&(g=a.charCodeAt(p),48<=g&&57>=g);p++);if(46==a.charCodeAt(p)){for(d=++p;d<b&&(g=a.charCodeAt(d),48<=g&&57>=g);d++);d==p&&
l();p=d}g=a.charCodeAt(p);if(101==g||69==g){g=a.charCodeAt(++p);43!=g&&45!=g||p++;for(d=p;d<b&&(g=a.charCodeAt(d),48<=g&&57>=g);d++);d==p&&l();p=d}return+a.slice(e,p)}f&&l();if("true"==a.slice(p,p+4))return p+=4,!0;if("false"==a.slice(p,p+5))return p+=5,!1;if("null"==a.slice(p,p+4))return p+=4,null;l()}return"$"},k=function(a){var b,c;"$"==a&&l();if("string"==typeof a){if("@"==(u?a.charAt(0):a[0]))return a.slice(1);if("["==a){for(b=[];;c||(c=!0)){a=z();if("]"==a)break;c&&(","==a?(a=z(),"]"==a&&l()):
l());","==a&&l();b.push(k(a))}return b}if("{"==a){for(b={};;c||(c=!0)){a=z();if("}"==a)break;c&&(","==a?(a=z(),"}"==a&&l()):l());","!=a&&"string"==typeof a&&"@"==(u?a.charAt(0):a[0])&&":"==z()||l();b[a.slice(1)]=k(z())}return b}l()}return a},G=function(a,b,c){c=t(a,b,c);c===d?delete a[b]:a[b]=c},t=function(a,c,e){var d=a[c],f;if("object"==typeof d&&d)if("[object Array]"==b.call(d))for(f=d.length;f--;)G(d,f,e);else r(d,function(a){G(d,a,e)});return e.call(a,c,d)};h.parse=function(a,c){var d;p=0;L=
""+a;a=k(z());"$"!=z()&&l();p=L=null;return c&&"[object Function]"==b.call(c)?t((d={},d[""]=a,d),"",c):a}}}})(this)},{}],50:[function(f,h,g){h.exports=function(c,a){for(var b=[],e=(a=a||0)||0;e<c.length;e++)b[e-a]=c[e];return b}},{}]},{},[1])(1)});
!function(q,f,h){"undefined"!=typeof module&&module.exports?module.exports=h():"function"==typeof define&&define.amd?define(f,h):q[f]=h()}(this,"bowser",function(){function q(a){function b(b){return(b=a.match(b))&&1<b.length&&b[1]||""}function d(b){return(b=a.match(b))&&1<b.length&&b[2]||""}function f(a){switch(a){case "NT":return"NT";case "XP":return"XP";case "NT 5.0":return"2000";case "NT 5.1":return"XP";case "NT 5.2":return"2003";case "NT 6.0":return"Vista";case "NT 6.1":return"7";case "NT 6.2":return"8";
case "NT 6.3":return"8.1";case "NT 10.0":return"10"}}var g=b(/(ipod|iphone|ipad)/i).toLowerCase(),h=!/like android/i.test(a)&&/android/i.test(a),q=/nexus\s*[0-6]\s*/i.test(a),v=!q&&/nexus\s*[0-9]+/i.test(a),y=/CrOS/.test(a),w=/silk/i.test(a),E=/sailfish/i.test(a),r=/tizen/i.test(a),C=/(web|hpw)os/i.test(a),B=/windows phone/i.test(a);/SamsungBrowser/i.test(a);var I=!B&&/windows/i.test(a),J=!g&&!w&&/macintosh/i.test(a),P=!h&&!E&&!r&&!C&&/linux/i.test(a),F=b(/edge\/(\d+(\.\d+)?)/i),p=b(/version\/(\d+(\.\d+)?)/i),
L=/tablet/i.test(a)&&!/tablet pc/i.test(a),l=!L&&/[^-]mobi/i.test(a),z=/xbox/i.test(a),k;/opera/i.test(a)?k={name:"Opera",opera:c,version:p||b(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr|opios/i.test(a)?k={name:"Opera",opera:c,version:b(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||p}:/SamsungBrowser/i.test(a)?k={name:"Samsung Internet for Android",samsungBrowser:c,version:p||b(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/coast/i.test(a)?k={name:"Opera Coast",coast:c,version:p||b(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:
/yabrowser/i.test(a)?k={name:"Yandex Browser",yandexbrowser:c,version:p||b(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(a)?k={name:"UC Browser",ucbrowser:c,version:b(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(a)?k={name:"Maxthon",maxthon:c,version:b(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(a)?k={name:"Epiphany",epiphany:c,version:b(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(a)?k={name:"Puffin",puffin:c,version:b(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(a)?
k={name:"Sleipnir",sleipnir:c,version:b(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(a)?k={name:"K-Meleon",kMeleon:c,version:b(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:B?(k={name:"Windows Phone",windowsphone:c},F?(k.msedge=c,k.version=F):(k.msie=c,k.version=b(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(a)?k={name:"Internet Explorer",msie:c,version:b(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:y?k={name:"Chrome",chromeos:c,chromeBook:c,chrome:c,version:b(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:
/chrome.+? edge/i.test(a)?k={name:"Microsoft Edge",msedge:c,version:F}:/vivaldi/i.test(a)?k={name:"Vivaldi",vivaldi:c,version:b(/vivaldi\/(\d+(\.\d+)?)/i)||p}:E?k={name:"Sailfish",sailfish:c,version:b(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(a)?k={name:"SeaMonkey",seamonkey:c,version:b(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(a)?(k={name:"Firefox",firefox:c,version:b(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(a)&&
(k.firefoxos=c)):w?k={name:"Amazon Silk",silk:c,version:b(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(a)?k={name:"PhantomJS",phantom:c,version:b(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(a)?k={name:"SlimerJS",slimer:c,version:b(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(a)||/rim\stablet/i.test(a)?k={name:"BlackBerry",blackberry:c,version:p||b(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:C?(k={name:"WebOS",webos:c,version:p||b(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(a)&&(k.touchpad=
c)):/bada/i.test(a)?k={name:"Bada",bada:c,version:b(/dolfin\/(\d+(\.\d+)?)/i)}:r?k={name:"Tizen",tizen:c,version:b(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||p}:/qupzilla/i.test(a)?k={name:"QupZilla",qupzilla:c,version:b(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||p}:/chromium/i.test(a)?k={name:"Chromium",chromium:c,version:b(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||p}:/chrome|crios|crmo/i.test(a)?k={name:"Chrome",chrome:c,version:b(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:h?k={name:"Android",version:p}:
/safari|applewebkit/i.test(a)?(k={name:"Safari",safari:c},p&&(k.version=p)):g?(k={name:"iphone"==g?"iPhone":"ipad"==g?"iPad":"iPod"},p&&(k.version=p)):/googlebot/i.test(a)?k={name:"Googlebot",googlebot:c,version:b(/googlebot\/(\d+(\.\d+))/i)||p}:k={name:b(/^(.*)\/(.*) /),version:d(/^(.*)\/(.*) /)};!k.msedge&&/(apple)?webkit/i.test(a)?(/(apple)?webkit\/537\.36/i.test(a)?(k.name=k.name||"Blink",k.blink=c):(k.name=k.name||"Webkit",k.webkit=c),!k.version&&p&&(k.version=p)):!k.opera&&/gecko\//i.test(a)&&
(k.name=k.name||"Gecko",k.gecko=c,k.version=k.version||b(/gecko\/(\d+(\.\d+)?)/i));k.windowsphone||k.msedge||!h&&!k.silk?k.windowsphone||k.msedge||!g?J?k.mac=c:z?k.xbox=c:I?k.windows=c:P&&(k.linux=c):(k[g]=c,k.ios=c):k.android=c;y="";k.windows?y=f(b(/Windows ((NT|XP)( \d\d?.\d)?)/i)):k.windowsphone?y=b(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):k.mac?(y=b(/Mac OS X (\d+([_\.\s]\d+)*)/i),y=y.replace(/[_\s]/g,".")):g?(y=b(/os (\d+([_\s]\d+)*) like mac os x/i),y=y.replace(/[_\s]/g,".")):h?y=b(/android[ \/-](\d+(\.\d+)*)/i):
k.webos?y=b(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):k.blackberry?y=b(/rim\stablet\sos\s(\d+(\.\d+)*)/i):k.bada?y=b(/bada\/(\d+(\.\d+)*)/i):k.tizen&&(y=b(/tizen[\/\s](\d+(\.\d+)*)/i));y&&(k.osversion=y);y=!k.windows&&y.split(".")[0];if(L||v||"ipad"==g||h&&(3==y||4<=y&&!l)||k.silk)k.tablet=c;else if(l||"iphone"==g||"ipod"==g||h||q||k.blackberry||k.webos||k.bada)k.mobile=c;return k.msedge||k.msie&&10<=k.version||k.yandexbrowser&&15<=k.version||k.vivaldi&&1<=k.version||k.chrome&&20<=k.version||k.samsungBrowser&&
4<=k.version||k.firefox&&20<=k.version||k.safari&&6<=k.version||k.opera&&10<=k.version||k.ios&&k.osversion&&6<=k.osversion.split(".")[0]||k.blackberry&&10.1<=k.version||k.chromium&&20<=k.version?k.a=c:k.msie&&10>k.version||k.chrome&&20>k.version||k.firefox&&20>k.version||k.safari&&6>k.version||k.opera&&10>k.version||k.ios&&k.osversion&&6>k.osversion.split(".")[0]||k.chromium&&20>k.version?k.c=c:k.x=c,k}function f(a,c){var b=[],e;if(Array.prototype.map)return Array.prototype.map.call(a,c);for(e=0;e<
a.length;e++)b.push(c(a[e]));return b}function h(a){var b=Math.max(a[0].split(".").length,a[1].split(".").length);for(a=f(a,function(a){var c=b-a.split(".").length;return a+=Array(c+1).join(".0"),f(a.split("."),function(a){return Array(20-a.length).join("0")+a}).reverse()});0<=--b;){if(a[0][b]>a[1][b])return 1;if(a[0][b]!==a[1][b])return-1;if(0===b)return 0}}function g(b,c,d){var e=a;"string"==typeof c&&(d=c,c=void 0);void 0===c&&(c=!1);d&&(e=q(d));d=""+e.version;for(var f in b)if(b.hasOwnProperty(f)&&
e[f]){if("string"!=typeof b[f])throw Error("Browser version in the minVersion map should be a string: "+f+": "+String(b));return 0>h([d,b[f]])}return c}var c=!0,a=q("undefined"!=typeof navigator?navigator.userAgent||"":"");return a.test=function(b){for(var c=0;c<b.length;++c){var d=b[c];if("string"==typeof d&&d in a)return!0}return!1},a.isUnsupportedBrowser=g,a.compareVersions=h,a.check=function(a,c,d){return!g(a,c,d)},a._detect=q,a});
navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia;window.RTCPeerConnection=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection;window.RTCSessionDescription=window.RTCSessionDescription||window.webkitRTCSessionDescription||window.mozRTCSessionDescription;window.RTCIceCandidate=window.RTCIceCandidate||window.webkitRTCIceCandidate||window.mozRTCIceCandidate;window.AudioContext=window.AudioContext||window.webkitAudioContext;
window.AudioContext.createGain=window.AudioContext.createGain||window.AudioContext.createGainNode;var luteg=luteg||{};
luteg.connector=function(q){function f(a,b){v[a]=v[a]||[];b=b||[];v[a].forEach(function(a){a.apply(this,b)})}function h(a){w==w||{};var b=w[a.id];"undefined"===typeof b&&(b=new E,b._id=a.id,w[a.id]=b);d.clients=d.clients||{};b=d.clients[a.id];"undefined"===typeof b&&(b=new y,b.id=a.id,b.customProperties=a.customProperties||{},d.clients[a.id]=b)}function g(){var a="";bowser.mac?a="macOS":bowser.windows?a="Windows":bowser.windowsphone?a="Windows Phone":bowser.linux?a="Linux":bowser.chromeos?a="Chrome OS":
bowser.android?a="Android":bowser.ios?a="iOS":bowser.blackberry?a="BlackBerry":bowser.firefoxos?a="Firefox OS":bowser.webos||bowser.touchpad?a="Web OS":bowser.bada?a="Bada":bowser.tizen?a="Tizen":bowser.sailfish&&(a="Sailfish OS");bowser.osversion&&(a+=" "+bowser.osversion);return a}function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})}function a(a,b){1==arguments.length&&(b=a,a="");var c=a;0<c.length&&
(c+=" : ");if("object"===typeof b)for(var d in b)0<c.length&&(c+="\n"),c+=d+" : "+b[d];else c+=b;u.debug&&console.log("[luteg.connector]","["+(new Date).toLocaleString()+"]",c)}function b(a){return"function"===typeof a?a:function(){}}var e=-1<navigator.userAgent.indexOf("Firefox"),d=this,m,n,x={},u={debug:void 0!==q&&void 0!=q.debug?q.debug:!1,serverUrl:"https://signaling.lupe.io",serverPath:"",appKey:void 0!==q&&void 0!=q.appKey?q.appKey:"",appSecret:void 0!==q&&void 0!=q.appSecret?q.appSecret:""};
this.options=function(a){if(a)a.hasOwnProperty("debug")&&(u.debug=a.debug),a.hasOwnProperty("serverUrl")&&(u.serverUrl=a.serverUrl),a.hasOwnProperty("serverPath")&&(u.serverPath=a.serverPath),a.hasOwnProperty("appKey")&&(u.appKey=a.appKey),a.hasOwnProperty("appSecret")&&(u.appSecret=a.appSecret);else return u};this.videoResolutions={default:0,qvga:1,vga:2,hd:3,fullHd:4};this.attachMediaStream=function(b,c){"undefined"!==typeof b.srcObject?b.srcObject=c:"undefined"!==typeof b.webkitSrcObject?b.webkitSrcObject=
c:"undefined"!==typeof b.mozSrcObject?b.mozSrcObject=c:"undefined"!==typeof b.src?b.src=URL.createObjectURL(c):a("mediaElement dosen't have srcObject or src property.")};this.getAudioSources=function(a,c){MediaStreamTrack&&MediaStreamTrack.getSources?MediaStreamTrack.getSources(function(c){for(var d=[],e=0;e<c.length;++e){var f=c[e];"audio"===f.kind&&d.push({id:f.id,label:f.label})}b(a)(d)}):b(c)("NOT_SUPPORTED")};this.getVideoSources=function(a,c){MediaStreamTrack&&MediaStreamTrack.getSources?MediaStreamTrack.getSources(function(c){for(var d=
[],e=0;e!==c.length;++e){var f=c[e];"video"===f.kind&&d.push({id:f.id,label:f.label})}b(a)(d)}):b(c)("NOT_SUPPORTED")};this.hasLocalMedia=function(){return"undefined"!==typeof n&&null!==n&&"undefined"!==typeof n.stream&&null!==n.stream};this.startLocalMedia=function(c,e,f){if(!d.hasLocalMedia())if("undefined"===typeof c)b(f)("AUDIO_OR_VIDEO_OPTION_MUST_BE_SET");else if("undefined"===typeof c.audio&&"undefined"===typeof c.video&&"undefined"===typeof c.audioSourceId&&"undefined"===typeof c.videoSourceId)b(f)("AUDIO_OR_VIDEO_OPTION_MUST_BE_SET");
else if("undefined"!==typeof c.audio&&"boolean"!==typeof c.audio)b(f)("AUDIO_OPTION_MUST_BE_BOOLEAN");else if("undefined"!==typeof c.video&&"boolean"!==typeof c.video)b(f)("VIDEO_OPTION_MUST_BE_BOOLEAN");else{var g=0,h={};if("boolean"===typeof c.video){var m=c.video;h.video=c.video}if("boolean"===typeof c.audio){var C=c.audio;h.audio=c.audio}if(("boolean"!==typeof h.audio||h.audio)&&"undefined"!==typeof c.audioSourceId&&0<c.audioSourceId.length){var r=c.audioSourceId;"object"===typeof h.audio?h.audio.optional=
[{sourceId:c.audioSourceId}]:h.audio={optional:[{sourceId:c.audioSourceId}]}}if("boolean"!==typeof h.video||h.video){if("undefined"!==typeof c.videoSourceId&&0<c.videoSourceId.length){var B=c.videoSourceId;"object"===typeof h.video?h.video.optional=[{sourceId:c.videoSourceId}]:h.video={optional:[{sourceId:c.videoSourceId}]}}if(c.videoResolution&&(g=c.videoResolution,c.videoResolution!==this.videoResolutions.default)){var l=0,q=0;c.videoResolution===this.videoResolutions.qvga?(l=320,q=180):c.videoResolution===
this.videoResolutions.vga?(l=640,q=360):c.videoResolution===this.videoResolutions.hd?(l=1280,q=720):c.videoResolution===this.videoResolutions.fullHd&&(l=1920,q=1080);0!=l&&0!=q&&("object"===typeof h.video?h.video.mandatory={minWidth:l,maxWidth:l,minHeight:q,maxHeight:q}:h.video={mandatory:{minWidth:l,maxWidth:l,minHeight:q,maxHeight:q}})}}d.hasLocalMedia()&&n.stream.stop();try{navigator.getUserMedia(h,function(c){n=n||{};n.audio=C;n.audioSourceId=r;n.video=m;n.videoSourceId=B;n.videoResolution=g;
n.stream=c;a("Local media is started");b(e)(c)},function(c){a("Error when starting local media. Error : ",c);b(f)(c)})}catch(k){a("Exception when starting local media. Exception : ",k),b(f)(k)}}};this.stopLocalMedia=function(c,d){n&&(n.stream&&(n.stream.stop(),a("Local media is stopped"),b(c)),n=null)};this.snapshot=function(a,b,c,d,e,f){c=c||0;d=d||0;e=e||a.videoWidth;f=f||a.videoHeight;b.width=e;b.height=f;b.getContext("2d").drawImage(a,c,d,e,f)};this.isConnected=function(){return"undefined"!==
typeof m&&null!==m&&m.connected};this.connect=function(b){if(!d.isConnected()){var c={transports:["websocket"],forceNew:!0};u.serverPath&&(c.path=u.serverPath);var e=[];u.appKey&&0<u.appKey.length&&e.push("_appKey\x3d"+u.appKey);u.appSecret&&0<u.appSecret.length&&e.push("_appSecret\x3d"+u.appSecret);e.push("_type\x3dweb");e.push("_device\x3dpc");e.push("_os\x3d"+g());if(b)for(var n in b)e.push(n+"\x3d"+b[n]);0<e.length&&(c.query=e.join("\x26"));m=io.connect(u.serverUrl,c);m.on("connect",function(){a("Connected to signaling server. Connection id : "+
m.id);f("connected",[null,m.id])});m.on("stunservers",function(b){a("Stun servers are received from signaling server. stun servers: "+JSON.stringify(b));u.iceServers=(u.iceServers||[]).concat(b)});m.on("turnservers",function(b){a("Turn servers are received from signaling server. turn servers: "+JSON.stringify(b));u.iceServers=(u.iceServers||[]).concat(b)});m.on("join",function(b,c){c.id!==m.id&&(a(c.id+" is joined to "+b+". Client : "+JSON.stringify(c)),h(c),f("clientJoined",[b,c]))});m.on("leave",
function(b,c){if(c.id!==m.id){a(c.id+" is left from "+b+". Client : "+JSON.stringify(c));var d=w[c.id];"undefined"!==typeof d&&d.destroy();f("clientLeft",[b,c])}});m.on("message",function(b){if(b&&b.type&&b.from&&b.to&&b.to===m.id){var c=b.from,d=w[c];d&&("offer"===b.type?(a("Received offer message from "+c+". Message : "+JSON.stringify(b)),d.handleOffer(b)):"answer"===b.type?(a("Received answer message from "+c+". Message : "+JSON.stringify(b)),d.handleAnswer(b)):"candidate"===b.type?(a("Received candidate message from "+
c+". Message : "+JSON.stringify(b)),d.handleCandidate(b)):"callRequest"===b.type?(a("Received call request from "+c+". Message : "+JSON.stringify(b)),d.handleCallRequest(b)):"callResponse"===b.type?(a("Received call response from "+c+". Message : "+JSON.stringify(b)),d.handleCallResponse(b)):"hangup"===b.type?(a("Received hangup from "+c+". Message : "+JSON.stringify(b)),d.handleHangup(b)):"dataChannelRequest"===b.type?(a("Received data channel request from "+c+". Message : "+JSON.stringify(b)),d.handleDataChannelRequest(b)):
"dataChannelResponse"===b.type?(a("Received data channel response from "+c+". Message : "+JSON.stringify(b)),d.handleDataChannelResponse(b)):"fileTransferRequest"===b.type?(a("Received file transfer request from "+c+". Message : "+JSON.stringify(b)),d.handleFileTransferRequest(b)):"fileTransferResponse"===b.type&&(a("Received file transfer response from "+c+". Message : "+JSON.stringify(b)),d.handleFileTransferResponse(b)))}else b&&b.type&&"iotData"==b.type&&(delete b.type,a("iotDataReceived : "+
JSON.stringify(b)),f("iotDataReceived",[b]))})}};this.disconnect=function(){if(d.isConnected()){var b=m.id;if(w)for(var c in w){var e=w[c];e&&e.destroy()}m.disconnect();m=null;a("Disconnected from signaling server. Connection id : "+b);f("disconnected",[null,b])}};this.join=function(b){"undefined"===typeof b||0===b.length?f("joined",["ROOM_NAME_MUST_BE_SET",b]):d.isConnected()?m.emit("joinToRoom",b,function(b,c,d){if(b)a("Error when joining to "+c+" room. Error : "+b),f("joined",[b,c]);else{a("Joined to "+
c+" room");for(b=0;b<d.length;b++)if(d[b].id===m.id){d.splice(b,1);break}for(b=0;b<d.length;b++)h(d[b]);f("joined",[null,c,d])}}):f("joined",["DISCONNECTED",b])};this.leave=function(){d.isConnected()?m.emit("leaveFromRoom",function(b,c){if(b)a("Error when leaving from "+c+" room. Error : "+b);else if(a("Left from "+c+" room"),w)for(var d in w){var e=w[d];e&&e.destroy()}f("left",[b,c])}):f("left",["DISCONNECTED",roomName])};var v={};this.on=function(a,b){v[a]=v[a]||[];v[a].push(b)};this.clients={};
var y=function(){this.hasCall=function(){return w[this.id]?w[this.id].hasCall():!1};this.call=function(a,b,c){d.isConnected()?w[this.id]?w[this.id].call(a,b,c):this.trigger("callFailed",["CLIENT_NOT_EXISTS",q]):this.trigger("callFailed",["DISCONNECTED",q])};this.hangup=function(a,c){d.isConnected()?w[this.id]?w[this.id].hangup(a,c):b(c)("CLIENT_NOT_EXISTS"):b(c)("DISCONNECTED")};this.openDataChannel=function(a,b){"undefined"===typeof a||0===a.length?this.trigger("dataChannelOpened",["CHANNEL_NAME_MUST_BE_SET",
a]):"c-00000000-0000-0000-0000-000000000000"===a?this.trigger("dataChannelOpened",["RESERVED_CHANNEL",a]):d.isConnected()?w[this.id]?w[this.id].openDataChannel(a,b):this.trigger("dataChannelOpened",["CLIENT_NOT_EXISTS",a]):this.trigger("dataChannelOpened",["DISCONNECTED",a])};this.closeDataChannel=function(a){"undefined"===typeof a||0===a.length?this.trigger("dataChannelClosed",["CHANNEL_NAME_MUST_BE_SET",a]):"c-00000000-0000-0000-0000-000000000000"===a?this.trigger("dataChannelClosed",["RESERVED_CHANNEL",
a]):d.isConnected()?w[this.id]?w[this.id].closeDataChannel(a):this.trigger("dataChannelClosed",["CLIENT_NOT_EXISTS",a]):this.trigger("dataChannelClosed",["DISCONNECTED",a])};this.sendMessage=function(a,b){"undefined"===typeof a||0===a.length?this.trigger("messageSent",["CHANNEL_NAME_MUST_BE_SET",a,b]):"c-00000000-0000-0000-0000-000000000000"===a?this.trigger("messageSent",["RESERVED_CHANNEL",a,b]):"undefined"===typeof b||0===b.length?this.trigger("messageSent",["MESSAGE_MUST_BE_SET",a,b]):d.isConnected()?
w[this.id]?w[this.id].sendDataChannelMessage(a,b):this.trigger("messageSent",["CLIENT_NOT_EXISTS",a,b]):this.trigger("messageSent",["DISCONNECTED",a,b])};this.sendFile=function(a,b){if("undefined"===typeof a)this.trigger("fileSent",["FILE_MUST_BE_SET",a]);else{var c={name:a.name,type:a.type,size:a.size};d.isConnected()?w[this.id]?w[this.id].sendFile(a,b):this.trigger("fileSent",["CLIENT_NOT_EXISTS",c]):this.trigger("fileSent",["DISCONNECTED",c])}};var a={};this.on=function(b,c){a[b]=a[b]||[];a[b].push(c)};
this.trigger=function(b,c){a[b]=a[b]||[];c=c||[];a[b].forEach(function(a){a.apply(this,c)})}},w={},E=function(){function f(b){if(!z||"closed"==z.signalingState){var c=u.iceServers?{iceServers:u.iceServers}:null;a("Creating peer connection for "+l._id+"...");z=new RTCPeerConnection(c,{optional:[{DtlsSrtpKeyAgreement:!0},{internalSctpDataChannels:!0}]});a("Peer connection is created for "+l._id+".");z.onicecandidate=function(b){b&&b.candidate&&(b=b.candidate,a("Candidate for "+l._id+". Candidate : "+
JSON.stringify(b)),F("candidate",{candidate:b.candidate,sdpMLineIndex:b.sdpMLineIndex,sdpMid:b.sdpMid}))};z.onnegotiationneeded=function(b){b&&a("\x3e\x3e\x3e\x3e\x3e\x3e\x3e\x3e\x3e\x3e onnegotiationneeded \x3c\x3c\x3c\x3c\x3c\x3c\x3c\x3c\x3c\x3c")};z.onaddstream=function(b){b&&b.stream&&(a("Stream is added for "+l._id+"."),d.clients[l._id].trigger("streamAdded",[b.stream]),d.clients[l._id].trigger("callSucceed",[{audio:k.receiveAudio,video:k.receiveVideo}]))};z.onremovestream=function(b){b&&b.stream&&
(a("Stream is removed for "+l._id+"."),d.clients[l._id].trigger("streamRemoved",[]))};z.ondatachannel=function(b){if(b&&b.channel){var c=b.channel.label;"c-00000000-0000-0000-0000-000000000000"===c?(G=b.channel,h(G),a("Common data channel is added for "+l._id+".")):(g({channelInfo:{name:c,isRemote:!0}}),t[c].dataChannel=b.channel,h(t[c].dataChannel),a(c+" channel is added for "+l._id+"."))}};z.oniceconnectionstatechange=function(b){this&&(b=this.iceConnectionState,a("ConnectionState is changed for "+
l._id+". State : "+b),d.clients[l._id]&&d.clients[l._id].trigger("connectionStateChanged",[b]),"closed"!=b&&"disconnected"!=b||l.close())};z.onsignalingstatechange=function(b){this&&a("SignalingState is changed for "+l._id+". State : "+this.signalingState)};b||G||(a("Creating common data channel for "+l._id+"..."),G=z.createDataChannel("c-00000000-0000-0000-0000-000000000000",x),a("Common data channel is created for "+l._id+"."),h(G));M=!1;N=[]}}function g(a){a=a||{};var b=!1;if(a.channelInfo){if(a.channelInfo.name)var c=
a.channelInfo.name;a.channelInfo.hasOwnProperty("isRemote")&&(b=a.channelInfo.isRemote)}c&&(t=t||{},t[c]||(t[c]={},t[c].isRemote=b,a.fileInfo&&(t[c].fileInfo=a.fileInfo)))}function h(b){b.onopen=function(c){var e=b.label;if("c-00000000-0000-0000-0000-000000000000"===e)a("Common channel is opened for "+l._id+".");else{c=p(e);var f=E(e,t[e].fileInfo);a(e+" channel is opened for "+l._id+"."+f);if(c){var g=t[e].fileInfo;if(g.file){var h={name:g.name,type:g.type,size:g.size};a("Transfering "+g.name+"file to "+
l._id+"."+f);var k=function(b){var c=new window.FileReader;c.onload=function(){return function(c){w[l._id].sendDataChannelMessage(e,c.target.result);g.size>b+c.target.result.byteLength&&window.setTimeout(k,0,b+16384);c=b+c.target.result.byteLength;a("Transfered "+c+" to "+l._id+"."+f);d.clients[l._id].trigger("fileDataSent",[h,c]);c==g.size&&(a("Transfered "+g.name+" file to "+l._id+"."+f),d.clients[l._id].trigger("fileSent",[null,h]))}}(g.file);var A=g.file.slice(b,b+16384);c.readAsArrayBuffer(A)};
k(0)}}else d.clients[l._id].trigger("dataChannelOpened",[null,e])}};b.onclose=function(){var c=b.label;if("c-00000000-0000-0000-0000-000000000000"==c)a("Common channel is closed for "+l._id+"."),G=null;else{var e=p(c);a(c+" channel is closed for "+l._id+".");t&&t[c]&&delete t[c];e||d.clients[l._id]&&d.clients[l._id].trigger("dataChannelClosed",[null,c])}};b.onerror=function(c){var e=b.label;if("c-00000000-0000-0000-0000-000000000000"===e)a("Error on Common channel for "+l._id+". Error : "+c);else{var f=
E(e,t[e].fileInfo);a("Error on "+e+" channel for "+l._id+"."+f+" Error : "+c);p(e)||d.clients[l._id]&&d.clients[l._id].trigger("dataChannelError",[c,e])}};b.onmessage=function(c){var e=b.label;if("c-00000000-0000-0000-0000-000000000000"===e){c=c.data;var f=E("Common");a("Message from "+l._id+". "+f+" - Message : "+c);JSON.parse(c)}else{var g=p(e);f=E(e,t[e].fileInfo);t&&t[e]&&(g?(g=t[e].fileInfo,g={name:g.name,type:g.type,size:g.size},t[e].receiveBuffer||(t[e].receiveBuffer=[]),t[e].receiveBuffer.push(c.data),
t[e].receivedSize||(t[e].receivedSize=0),t[e].receivedSize+=c.data.byteLength,a("File data from "+l._id+". "+f+" Received : "+t[e].receivedSize),d.clients[l._id].trigger("fileDataReceived",[g,t[e].receivedSize]),t[e].receivedSize===t[e].fileInfo.size&&(c=new window.Blob(t[e].receiveBuffer),c=URL.createObjectURL(c),a("File transfer completed from "+l._id+"."+f),d.clients[l._id].trigger("fileReceived",[null,g,c]),l.closeDataChannel(e))):(c=c.data,a("Message from "+l._id+". "+f+" - Message : "+c),d.clients[l._id].trigger("messageReceived",
[e,c])))}}}function q(){var b={offerToReceiveAudio:k&&k.receiveAudio,offerToReceiveVideo:k&&k.receiveVideo};console.log(b);f(!1);a("Creating offer for "+l._id+" ... ");z.createOffer(function(b){a("Offer is created for "+l._id+".");a("Setting local description for "+l._id+".");z.setLocalDescription(b,function(){a("Local description is set for "+l._id+".");a("Sending offer to "+l._id+".");F(b.type,{type:b.type,sdp:b.sdp})},function(b){a("Local description could not be set for "+l._id+". Error : "+b)})},
function(b){a("Offer could not be created for "+l._id+". Error : "+b)},b)}function v(){var b={mandatory:{OfferToReceiveAudio:k&&k.receiveAudio,OfferToReceiveVideo:k&&k.receiveVideo}};d.hasLocalMedia()&&k&&!k.didSetLocalStream&&(a("Adding local stream to "+l._id+" connection..."),z.addStream(n.stream),a("Local stream is added to "+l._id+" connection."),k.didSetLocalStream=!0);f(!0);a("Creating answer for "+l._id+"... ");z.createAnswer(function(b){a("Answer is created for "+l._id+".");a("Setting local description for "+
l._id+"...");z.setLocalDescription(b,function(){a("Local description is set for "+l._id+".");a("Sending answer to "+l._id+"...");F(b.type,{type:b.type,sdp:b.sdp})},function(b){a("Local description could not be set for "+l._id+". Error : "+b)})},function(b){a("Answer could not be created for "+l._id+". Error : "+b)},b)}function y(){for(M=!0;0<N.length;){var b=N.shift();a("Adding candidate for "+candidate.from+"...");z.addIceCandidate(new RTCIceCandidate(b.payload),function(){a("Candidate is added for "+
candidate.from+".")},function(b){a("Candidate could not be added for "+candidate.from+". Error : "+b)})}}function F(b,c){a("Sending message to "+l._id+". Type : "+b+" - Message : "+JSON.stringify(c));m.emit("message",{to:l._id,type:b,payload:c})}function p(a){return t&&t[a]&&t[a].fileInfo&&t[a].fileInfo.name&&0<t[a].fileInfo.name.length}function E(a,b){var c="";"undefined"!==typeof a&&null!=a&&(c="string"===typeof a&&0<a.length?c+(" - Channel : "+a):c+(" - Channel : "+JSON.stringify(a)));"undefined"!==
typeof b&&null!=b&&(c="string"===typeof b&&0<b.length?c+(" - File : "+b):c+(" - File : "+JSON.stringify({name:b.name,type:b.type,size:b.size})));return c}var l=this,z,k,G,t,M=!1,N=[];this.handleOffer=function(b){a("Handling offer from "+l._id+"... ");f(!0);a("Setting remote description for "+l._id+"... ");z.setRemoteDescription(new RTCSessionDescription(b.payload),function(){e&&y();a("Remote description is set for "+l._id+".");a("Creating answer for "+l._id+"...");v()},function(b){a("Remote description could not be set for "+
l._id+". Error : "+b)})};this.handleAnswer=function(b){a("Handling answer from "+l._id+"...");f(!1);a("Setting remote description for "+l._id+"...");z.setRemoteDescription(new RTCSessionDescription(b.payload),function(){e&&y(channelName);a("Remote description is set for "+l._id+".")},function(b){a("Remote description could not be set for "+l._id+". Error : "+b)})};this.handleCandidate=function(b){a("Handling candidate from "+l._id+"...");f();a("Adding candidate for "+l._id+"...");var c=!0;e&&!M&&
(c=!1,N.push(b),a("Candidate could not be added for "+l._id+". Because, remote description is not set yet."));c&&z.addIceCandidate(new RTCIceCandidate(b.payload),function(){a("Candidate is added for "+l._id+".")},function(b){a("Candidate could not be added for "+l._id+". Error : "+b)})};this.close=function(){a("Disconnecting from "+l._id+"...");if(t)for(var b in t)l.closeDataChannel(b);G&&G.close();z&&"closed"!==z.signalingState&&z.close()};this.destroy=function(){a("Disconnecting from "+l._id+"...");
if(t)for(var b in t)l.closeDataChannel(b);G&&G.close();z&&"closed"!==z.signalingState&&z.close();delete w[l._id];delete d.clients[l._id]};this.hasCall=function(){return"undefined"!==typeof k&&null!==k};this.call=function(a,b,e){if(l.hasCall())d.clients[l._id].trigger("callFailed",["CALL_EXISTS",f]);else if(d.hasLocalMedia()){var f={audio:a,video:b};"undefined"===typeof a&&"undefined"===typeof b?d.clients[l._id].trigger("callFailed",["AUDIO_OR_VIDEO_OPTION_MUST_BE_SET",f]):"undefined"!==typeof a&&
"boolean"!==typeof a?d.clients[l._id].trigger("callFailed",["AUDIO_OPTION_MUST_BE_BOOLEAN",f]):"undefined"!==typeof b&&"boolean"!==typeof b?d.clients[l._id].trigger("callFailed",["VIDEO_OPTION_MUST_BE_BOOLEAN",f]):a||b?(a={sessionId:c(),sendAudio:n.audio||n.audioSourceId&&0<n.audioSourceId.length,sendVideo:n.video||n.videoSourceId&&0<n.videoSourceId.length,receiveAudio:a,receiveVideo:b,confirmationMessage:e||""},F("callRequest",a),d.clients[l._id].trigger("calling",["AUDIO_OR_VIDEO_OPTION_MUST_BE_SET",
f])):d.clients[l._id].trigger("callFailed",["AUDIO_OR_VIDEO_OPTION_MUST_BE_SET",f])}else d.clients[l._id].trigger("callFailed",["LOCAL_MEDIA_NOT_EXISTS",f])};this.handleCallRequest=function(b){a("Handling call request from "+l._id+" connection... ");if(!l.hasCall()){var c=b.payload,e={sessionId:c.sessionId,sendAudio:c.sendAudio,sendVideo:c.sendVideo,receiveAudio:c.receiveAudio,receiveVideo:c.receiveVideo};d.clients[l._id].trigger("callRequestReceived",[{audio:c.receiveAudio,video:c.receiveVideo,confirmationMessage:c.confirmationMessage},
function(){k={sessionId:c.sessionId,sendAudio:c.receiveAudio,sendVideo:c.receiveVideo,receiveAudio:c.sendAudio,receiveVideo:c.sendVideo,didSetLocalStream:!1};e.accepted=!0;F("callResponse",e)},function(){e.accepted=!1;F("callResponse",e)}])}};this.handleCallResponse=function(b){a("Handling call response from "+l._id+" connection... ");if(!l.hasCall()){var c=b.payload;b={audio:c.receiveAudio,video:c.receiveVideo};"boolean"===typeof c.accepted&&c.accepted?(a("Call is accepted by "+l._id+" connection."),
k={sessionId:c.sessionId,sendAudio:c.sendAudio,sendVideo:c.sendVideo,receiveAudio:c.receiveAudio,receiveVideo:c.receiveVideo,didSetLocalStream:!1},f(!1),c=!1,d.hasLocalMedia()&&k&&!k.didSetLocalStream&&(a("Adding local stream to "+l._id+"."),z.addStream(n.stream),a("Local stream is added to "+l._id+"."),c=k.didSetLocalStream=!0),c&&q(),d.clients[l._id].trigger("callRequestAccepted",[b])):(a("Call is declined by "+l._id+" connection."),d.clients[l._id].trigger("callRequestDeclined",[b]))}};this.hangup=
function(c,d){l.hasCall()?(F("hangup",{sessionId:k.sessionId}),f(!1),d=!1,k&&k.didSetLocalStream&&(a("Removing local stream from "+l._id+"."),z.removeStream(n.stream),a("Local stream is removed from "+l._id+"."),d=!0),k=null,d&&q(),b(c)):b(d)("CALL_NOT_EXISTS")};this.handleHangup=function(b){a("Handling hangup from "+l._id+"...");l.hasCall()?(f(!1),k&&k.didSetLocalStream&&(a("Removing local stream from "+l._id+"."),z.removeStream(n.stream),a("Local stream is removed from "+l._id+".")),k=null,d.clients[l._id].trigger("callHungup",
[])):a("There is no call with "+l._id+".")};this.openDataChannel=function(a,b){t&&t[a]?d.clients[l._id].trigger("dataChannelOpened",["CHANNEL_ALREADY_EXISTS",a]):F("dataChannelRequest",{name:a,confirmationMessage:b})};this.createDataChannel=function(b,c){if(!(t&&t[b]&&t[b].dataChannel)){var d="undefined"===typeof z;f(!1);g({channelInfo:{name:b,isRemote:!1},fileInfo:c});c=E(b,c);a("Creating '"+b+"' channel for "+l._id+"..."+c);t[b].dataChannel=z.createDataChannel(b,{ordered:!0});var e=p(b);e&&(t[b].dataChannel.binaryType=
"arraybuffer");h(t[b].dataChannel,e);a("'"+b+"' channel is created for "+l._id+"."+c);d&&q()}};this.closeDataChannel=function(b){t&&t[b]?t[b]&&t[b].dataChannel?(a("Closing "+b+" channel for "+l.id+"..."),t[b].dataChannel.close()):delete t[b]:d.clients[l._id].trigger("dataChannelClosed",["f",b])};this.sendDataChannelMessage=function(b,c){"c-00000000-0000-0000-0000-000000000000"===b&&G?G.send(c):t&&t[b]&&t[b].dataChannel?(a("Sending message to "+l.id+"... Channel: "+b+" - Messsage: "+c),t[b].dataChannel.send(c),
d.clients[l._id].trigger("messageSent",[null,b,c])):d.clients[l._id].trigger("messageSent",["CHANNEL_NOT_EXISTS",b,c])};this.handleDataChannelRequest=function(b){a("Handling data channel request from "+l._id+"...");b=b.payload;var c=b.name,e={name:c};d.clients[l._id].trigger("dataChannelRequestReceived",[{name:c,confirmationMessage:b.confirmationMessage},function(){e.accepted=!0;F("dataChannelResponse",e)},function(){e.accepted=!1;F("dataChannelResponse",e)}])};this.handleDataChannelResponse=function(b){a("Handling data channel response from "+
l._id+"...");b=b.payload;var c=b.name;"boolean"===typeof b.accepted&&b.accepted?(a("Data channel is accepted by "+l._id+" connection. Channel : "+c),l.createDataChannel(c),d.clients[l._id].trigger("dataChannelRequestAccepted",[{name:c}])):(a("Data channel is declined by "+l._id+" connection. Channel : "+c),d.clients[l._id].trigger("dataChannelRequestDeclined",[{name:c}]))};this.sendFile=function(a,b){var d="file-"+c();a={name:a.name,type:a.type,size:a.size,file:a};g({channelInfo:{name:d,isRemote:!1},
fileInfo:a});F("fileTransferRequest",{channelName:d,name:a.name,type:a.type,size:a.size,confirmationMessage:b})};this.handleFileTransferRequest=function(b){a("Handling file transfer request from "+l._id+" connection... ");var c=b.payload,e={name:c.name,type:c.type,size:c.size},f={channelName:c.channelName,name:e.name,type:e.type,size:e.size};d.clients[l._id].trigger("fileTransferRequestReceived",[{file:e,confirmationMessage:c.confirmationMessage},function(){g({channelInfo:{name:c.channelName,isRemote:!0},
fileInfo:e});f.accepted=!0;F("fileTransferResponse",f)},function(){f.accepted=!1;F("fileTransferResponse",f)}])};this.handleFileTransferResponse=function(b){a("Handling file transfer response from "+l._id+" connection... ");b=b.payload;var c=b.channelName,e={name:b.name,type:b.type,size:b.size};"boolean"===typeof b.accepted&&b.accepted?(a("File transfer is accepted by "+l._id+" connection. File : "+JSON.stringify(e)),l.createDataChannel(c,e),d.clients[l._id].trigger("fileTransferRequestAccepted",
[{file:e}])):(a("File transfer is declined by "+l._id+" connection. File : "+JSON.stringify(e)),l.closeDataChannel(c),d.clients[l._id].trigger("fileTransferRequestDeclined",[{file:e}]))}}};
